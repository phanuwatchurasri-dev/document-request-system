<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-50 to-rose-100 min-h-screen">
    <!-- Main Page -->
    <div id="mainPage" class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <div></div>
                    <div class="text-center">
                        <h1 class="text-4xl font-bold text-blue-600 mb-2">üìö ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h1>
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£ üè´ ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏î‡∏¥‡∏©‡∏ê‡πå</h2>
                        <p class="text-gray-600">‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÅ‡∏•‡∏∞‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="showAdminLogin()" class="bg-gradient-to-r from-purple-500 to-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-purple-600 hover:to-indigo-600 transition-all duration-200">
                            üë®‚Äçüíº Admin Login
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Menu -->
        <div class="grid md:grid-cols-3 gap-8 max-w-4xl mx-auto">
            <!-- Submit Request Menu -->
            <div class="bg-white rounded-2xl shadow-lg p-8 text-center hover:shadow-xl transition-all duration-300 cursor-pointer transform hover:scale-105" onclick="showSubmitPage()">
                <div class="text-6xl mb-6">üìù</div>
                <h2 class="text-2xl font-bold text-pink-800 mb-4">‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>
                <p class="text-gray-600 mb-6">‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡πÉ‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                <div class="bg-gradient-to-r from-pink-600 to-rose-600 text-white py-3 px-6 rounded-lg font-semibold hover:from-pink-700 hover:to-rose-700 transition-all duration-200">
                    ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠ ‚Üí
                </div>
            </div>

            <!-- Track Request Menu -->
            <div class="bg-white rounded-2xl shadow-lg p-8 text-center hover:shadow-xl transition-all duration-300 cursor-pointer transform hover:scale-105" onclick="showTrackingPage()">
                <div class="text-6xl mb-6">üîç</div>
                <h2 class="text-2xl font-bold text-blue-800 mb-4">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏Ç‡∏≠</h2>
                <p class="text-gray-600 mb-6">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠</p>
                <div class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 px-6 rounded-lg font-semibold hover:from-blue-700 hover:to-indigo-700 transition-all duration-200">
                    ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏Ç‡∏≠ ‚Üí
                </div>
            </div>

            <!-- Admin Menu -->
            <div class="bg-white rounded-2xl shadow-lg p-8 text-center hover:shadow-xl transition-all duration-300 cursor-pointer transform hover:scale-105" onclick="showAdminLogin()">
                <div class="text-6xl mb-6">üë®‚Äçüíº</div>
                <h2 class="text-2xl font-bold text-purple-800 mb-4">Admin</h2>
                <p class="text-gray-600 mb-6">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</p>
                <div class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-3 px-6 rounded-lg font-semibold hover:from-purple-700 hover:to-indigo-700 transition-all duration-200">
                    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö ‚Üí
                </div>
            </div>
        </div>

        <!-- Contact Information -->
        <div class="mt-8 bg-white rounded-2xl shadow-lg p-4">
            <h3 class="text-lg font-bold text-gray-800 mb-3 text-center">üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</h3>
            <div class="grid md:grid-cols-4 gap-3 text-center">
                <div class="flex flex-col items-center p-3 bg-blue-50 rounded-lg">
                    <div class="text-2xl mb-1">üìû</div>
                    <div class="font-medium text-blue-800 text-sm">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</div>
                    <div class="text-blue-600 text-sm">077-379034</div>
                </div>
                <div class="flex flex-col items-center p-3 bg-green-50 rounded-lg">
                    <div class="text-2xl mb-1">üìß</div>
                    <div class="font-medium text-green-800 text-sm">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</div>
                    <div class="text-green-600 text-sm">academic@kandit.ac.th</div>
                </div>
                <div class="flex flex-col items-center p-3 bg-purple-50 rounded-lg">
                    <div class="text-2xl mb-1">üè¢</div>
                    <div class="font-medium text-purple-800 text-sm">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</div>
                    <div class="text-purple-600 text-xs">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£<br>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏î‡∏¥‡∏©‡∏ê‡πå</div>
                </div>
                <div class="flex flex-col items-center p-3 bg-indigo-50 rounded-lg">
                    <div class="mb-1">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" fill="#1877F2"/>
                            <path d="M16.671 15.543l.532-3.47h-3.328v-2.25c0-.949.465-1.874 1.956-1.874h1.513V4.996s-1.374-.235-2.686-.235c-2.741 0-4.533 1.662-4.533 4.669v2.642H7.078v3.47h3.047v8.385a12.118 12.118 0 003.75 0v-8.385h2.796z" fill="#FFFFFF"/>
                        </svg>
                    </div>
                    <div class="font-medium text-indigo-800 text-sm">Facebook</div>
                    <a href="https://www.facebook.com/kanditschool" target="_blank" class="text-indigo-600 text-xs hover:text-indigo-800 hover:underline transition-colors duration-200">
                        ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏î‡∏¥‡∏©‡∏ê‡πå
                    </a>
                </div>
            </div>
        </div>

    </div>

    <!-- Submit Request Page -->
    <div id="submitPage" class="hidden container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <button onclick="goBackToMenu()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-gray-600 hover:to-gray-700 transition-all duration-200">
                        ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    </button>
                    <div>
                        <h1 class="text-3xl font-bold text-pink-800 mb-2">üìù ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h1>
                        <p class="text-gray-600">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
                    </div>
                    <div></div>
                </div>
            </div>
        </div>

        <!-- Document Request Form -->
        <div class="max-w-4xl mx-auto">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <form id="documentForm" class="space-y-6">
                    <!-- Personal Information -->
                    <div class="grid md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠ *</label>
                            <select id="titlePrefix" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</option>
                                <option value="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢">‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢</option>
                                <option value="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á">‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á</option>
                                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                                <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                            <input type="text" id="fullName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                            <input type="text" id="studentId" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" required>
                        </div>
                    </div>

                    <!-- Name Change History -->
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" id="hasNameChange" class="mr-3 text-pink-600" onchange="toggleOldNameField()">
                            <span class="text-sm font-medium text-gray-700">üîÑ ‡πÄ‡∏Ñ‡∏¢‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</span>
                        </label>
                        
                        <div id="oldNameField" class="hidden mt-4">
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πà‡∏≤ *</label>
                                    <select id="oldTitlePrefix" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
                                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</option>
                                        <option value="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢">‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢</option>
                                        <option value="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á">‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á</option>
                                        <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                        <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                                        <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏Å‡πà‡∏≤ *</label>
                                    <input type="text" id="oldName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏Å‡πà‡∏≤">
                                </div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">üí° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏î‡∏¥‡∏°</p>
                        </div>
                    </div>

                    <!-- Student Status Selection -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <label class="block text-sm font-medium text-gray-700 mb-3">‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û *</label>
                        <div class="space-y-3">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="studentStatus" value="current" id="currentStudent" class="mr-3 text-pink-600" onchange="toggleGradeLevel()" required>
                                <span class="text-sm font-medium text-gray-700">üéì ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="studentStatus" value="alumni" id="alumniStudent" class="mr-3 text-pink-600" onchange="toggleGradeLevel()" required>
                                <span class="text-sm font-medium text-gray-700">üë®‚Äçüéì ‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤</span>
                            </label>
                        </div>
                        
                        <!-- Grade Level Field (only for current students) -->
                        <div id="gradeLevelField" class="hidden mt-4">
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô *</label>
                                    <select id="faculty" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" onchange="toggleRoomSelection()">
                                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option>
                                        <option value="‡∏°.1">‡∏°.1</option>
                                        <option value="‡∏°.2">‡∏°.2</option>
                                        <option value="‡∏°.3">‡∏°.3</option>
                                        <option value="‡∏°.4">‡∏°.4</option>
                                        <option value="‡∏°.5">‡∏°.5</option>
                                        <option value="‡∏°.6">‡∏°.6</option>
                                    </select>
                                </div>
                                <div id="roomField" class="hidden">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡πâ‡∏≠‡∏á *</label>
                                    <select id="room" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
                                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Graduation Year Field (only for alumni) -->
                        <div id="graduationYearField" class="hidden mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ *</label>
                            <input type="number" id="graduationYear" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567" min="2500" max="2600">
                            <p class="text-xs text-gray-500 mt-1">üí° ‡∏Å‡∏£‡∏≠‡∏Å‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏î‡∏¥‡∏©‡∏ê‡πå</p>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
                        <input type="tel" id="phone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå" required>
                    </div>

                    <!-- Document Selection -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-3">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ *</label>
                        <div class="space-y-3">
                            <label class="flex items-start p-4 border border-gray-200 rounded-lg hover:bg-pink-50 cursor-pointer">
                                <input type="checkbox" name="documents" value="‡∏õ‡∏û.1 ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤" class="mr-3 text-pink-600 mt-1">
                                <div class="text-sm">
                                    <div class="font-medium">üìú ‡∏õ‡∏û.1 ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
                                    <div class="text-gray-500 text-xs mt-1">(‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</div>
                                </div>
                            </label>
                            
                            <label class="flex items-start p-4 border border-gray-200 rounded-lg hover:bg-pink-50 cursor-pointer">
                                <input type="checkbox" name="documents" value="‡∏£‡∏ö.1 (‡∏ï/‡∏õ) ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ 2553 ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏Å‡πà‡∏≤" class="mr-3 text-pink-600 mt-1" onchange="toggleRb1Details(this)">
                                <div class="text-sm flex-1">
                                    <div class="font-medium">üìä ‡∏£‡∏ö.1 (‡∏ï/‡∏õ) ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                                    <div class="text-gray-500 text-xs mt-1">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ 2553 ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏Å‡πà‡∏≤</div>
                                    <div class="rb1-details-field hidden mt-3">
                                        <div class="grid grid-cols-1 gap-3">
                                            <div>
                                                <label class="block text-xs font-medium text-gray-600 mb-2">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ *</label>
                                                <div class="space-y-2">
                                                    <label class="flex items-center">
                                                        <input type="radio" name="rb1-level" value="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏ï‡πâ‡∏ô" class="rb1-level-input mr-2 text-pink-600">
                                                        <span class="text-xs">‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏ï‡πâ‡∏ô (‡∏°.1-‡∏°.3)</span>
                                                    </label>
                                                    <label class="flex items-center">
                                                        <input type="radio" name="rb1-level" value="‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢" class="rb1-level-input mr-2 text-pink-600">
                                                        <span class="text-xs">‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢ (‡∏°.4-‡∏°.6)</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-600 mb-1">‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö *</label>
                                                <input type="number" class="graduation-year-input w-32 px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567" min="2500" max="2600">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </label>
                            
                            <label class="flex items-start p-4 border border-gray-200 rounded-lg hover:bg-pink-50 cursor-pointer">
                                <input type="checkbox" name="documents" value="‡∏õ‡∏û.6 ‡πÉ‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="mr-3 text-pink-600 mt-1" onchange="toggleSemesterDetails(this)">
                                <div class="text-sm flex-1">
                                    <div class="font-medium">üìã ‡∏õ‡∏û.6 ‡πÉ‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                                    <div class="semester-details-field hidden mt-3">
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <label class="block text-xs font-medium text-gray-600 mb-1">‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                                                <select class="semester-input w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-pink-500 focus:border-transparent">
                                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3 (‡∏†‡∏≤‡∏Ñ‡∏§‡∏î‡∏π‡∏£‡πâ‡∏≠‡∏ô)</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-gray-600 mb-1">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ *</label>
                                                <input type="number" class="academic-year-input w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567" min="2500" max="2600">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </label>
                            
                            <label class="flex items-start p-4 border border-gray-200 rounded-lg hover:bg-pink-50 cursor-pointer">
                                <input type="checkbox" name="documents" value="‡∏õ‡∏û.7 ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤" class="mr-3 text-pink-600 mt-1">
                                <div class="text-sm">
                                    <div class="font-medium">üéì ‡∏õ‡∏û.7 ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
                                    <div class="text-gray-500 text-xs mt-1">(‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</div>
                                </div>
                            </label>
                            
                            <label class="flex items-start p-4 border border-gray-200 rounded-lg hover:bg-pink-50 cursor-pointer">
                                <input type="checkbox" name="documents" value="‡∏õ‡∏û.7 ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="mr-3 text-pink-600 mt-1">
                                <div class="text-sm">
                                    <div class="font-medium">üë§ ‡∏õ‡∏û.7 ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                                </div>
                            </label>
                            
                            <label class="flex items-start p-4 border border-gray-200 rounded-lg hover:bg-pink-50 cursor-pointer">
                                <input type="checkbox" name="documents" value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" class="mr-3 text-pink-600 mt-1" onchange="toggleOtherDocument(this)">
                                <div class="text-sm flex-1">
                                    <div class="font-medium">üìÑ ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</div>
                                    <div class="other-document-field hidden mt-3">
                                        <label class="block text-xs font-medium text-gray-600 mb-1">‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ *</label>
                                        <input type="text" class="other-document-input w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£">
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏â‡∏ö‡∏±‡∏ö) *</label>
                            <input type="number" id="quantity" min="1" max="10" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="1" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå *</label>
                            <select id="purpose" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" onchange="togglePurposeDetails()" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</option>
                                <option value="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡πà‡∏≠">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡πà‡∏≠</option>
                                <option value="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô</option>
                                <option value="‡∏Ç‡∏≠‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤">‡∏Ç‡∏≠‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                            
                            <!-- Purpose Details Field -->
                            <div id="purposeDetailsField" class="hidden mt-3">
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå *</label>
                                <input type="text" id="purposeDetails" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-gradient-to-r from-pink-600 to-rose-600 text-white py-4 px-6 rounded-lg font-semibold text-lg hover:from-pink-700 hover:to-rose-700 transition-all duration-200 shadow-lg">
                        üì§ ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Tracking Page -->
    <div id="trackingPage" class="hidden container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <button onclick="goBackToMenu()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-gray-600 hover:to-gray-700 transition-all duration-200">
                        ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    </button>
                    <div>
                        <h1 class="text-3xl font-bold text-blue-800 mb-2">üîç ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏Ç‡∏≠</h1>
                        <p class="text-gray-600">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</p>
                    </div>
                    <div></div>
                </div>
            </div>
        </div>

        <div class="max-w-4xl mx-auto space-y-8">
            <!-- Tracking Form -->
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-blue-800 mb-6 text-center">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏Ç‡∏≠</h2>
                
                <div class="max-w-2xl mx-auto">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏Ç‡∏≠</label>
                        <div class="flex space-x-3 mb-2">
                            <input type="text" id="trackingInput" class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠, ‡∏ä‡∏∑‡πà‡∏≠, ‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡πÄ‡∏ä‡πà‡∏ô REQ0001, ‡∏™‡∏°‡∏ä‡∏≤‡∏¢, ‡πÉ‡∏à‡∏î‡∏µ)">
                            <button onclick="searchRequests()" class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-indigo-700 transition-all duration-200">
                                üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                            </button>
                        </div>
                        <div class="text-xs text-gray-500 text-center">
                            üí° ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢: ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠ (REQ0001), ‡∏ä‡∏∑‡πà‡∏≠ (‡∏™‡∏°‡∏ä‡∏≤‡∏¢), ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡πÉ‡∏à‡∏î‡∏µ), ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                        </div>
                    </div>
                </div>

                <!-- Search Results -->
                <div id="searchResults" class="hidden mt-8">
                    <!-- Multiple results will be shown here -->
                </div>

                <!-- Single Tracking Result -->
                <div id="trackingResult" class="hidden mt-8 p-6 bg-blue-50 border border-blue-200 rounded-lg">
                    <h4 id="trackingTitle" class="font-semibold text-blue-800 mb-6 text-center text-xl">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏Ç‡∏≠</h4>
                    <div id="progressSteps" class="space-y-4">
                        <!-- Progress steps will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Recent Requests -->
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h3 class="text-2xl font-bold text-blue-800 mb-6 text-center">üìã ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                <div id="requestList" class="space-y-4">
                    <div class="text-gray-500 text-center py-12 bg-gray-50 rounded-lg">
                        <div class="text-6xl mb-4">üìÑ</div>
                        <div class="text-xl mb-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div>
                        <div class="text-sm">‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Page -->
    <div id="adminPage" class="hidden min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100">
        <div class="container mx-auto px-4 py-8">
            <!-- Admin Header -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-3xl font-bold text-purple-800 mb-2">üë®‚Äçüíº Admin Dashboard</h1>
                        <p class="text-gray-600">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <!-- Notification Bell -->
                        <div class="relative">
                            <button id="adminNotificationBell" onclick="showNotifications()" class="bg-gradient-to-r from-red-500 to-pink-500 text-white px-3 py-2 rounded-lg text-sm font-medium hover:from-red-600 hover:to-pink-600 transition-all duration-200 relative">
                                üîî
                                <span id="adminNotificationBadge" class="absolute -top-2 -right-2 bg-red-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold hidden">0</span>
                            </button>
                        </div>
                        <button onclick="goBackToMain()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-gray-600 hover:to-gray-700 transition-all duration-200">
                            üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                        </button>
                        <button onclick="adminLogout()" class="bg-gradient-to-r from-red-500 to-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-red-600 hover:to-red-700 transition-all duration-200">
                            üö™ Logout
                        </button>
                    </div>
                </div>
            </div>

            <!-- Admin Tabs -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex space-x-4 mb-6">
                    <button onclick="showAdminTab('requests')" id="requestsTab" class="px-6 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-all duration-200">
                        üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                    </button>
                    <button onclick="showAdminTab('statistics')" id="statisticsTab" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition-all duration-200">
                        üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                    </button>
                    <button onclick="showAdminTab('users')" id="usersTab" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition-all duration-200">
                        üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
                    </button>
                    <button onclick="showAdminTab('sheets')" id="sheetsTab" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition-all duration-200">
                        üìä ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets
                    </button>
                </div>

                <!-- Requests Tab -->
                <div id="requestsTabContent" class="admin-tab-content">
                    <h3 class="text-xl font-semibold text-purple-800 mb-6">üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h3>
                    <div id="adminRequestList" class="space-y-6">
                        <div class="text-gray-500 text-center py-12 bg-gray-50 rounded-lg">
                            <div class="text-4xl mb-4">üìÑ</div>
                            <div class="text-lg">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>
                            <div class="text-sm mt-2">‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà</div>
                        </div>
                    </div>
                </div>

                <!-- Statistics Tab -->
                <div id="statisticsTabContent" class="admin-tab-content hidden">
                    <h3 class="text-xl font-semibold text-purple-800 mb-6">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h3>
                    
                    <!-- Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg p-6 text-center">
                            <div class="text-3xl font-bold mb-2" id="totalRequests">0</div>
                            <div class="text-sm opacity-90">üìã ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        </div>
                        <div class="bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg p-6 text-center">
                            <div class="text-3xl font-bold mb-2" id="completedRequests">0</div>
                            <div class="text-sm opacity-90">‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß</div>
                        </div>
                        <div class="bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-lg p-6 text-center">
                            <div class="text-3xl font-bold mb-2" id="pendingRequests">0</div>
                            <div class="text-sm opacity-90">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                        </div>
                        <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg p-6 text-center">
                            <div class="text-3xl font-bold mb-2" id="todayRequests">0</div>
                            <div class="text-sm opacity-90">üìÖ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <!-- Document Types Chart -->
                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">üìÑ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h4>
                            <div id="documentTypesChart" class="space-y-3">
                                <!-- Chart will be generated here -->
                            </div>
                        </div>

                        <!-- Monthly Requests Chart -->
                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">üìà ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h4>
                            <div id="monthlyChart" class="space-y-3">
                                <!-- Chart will be generated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Status Distribution -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6 mb-8">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">üîÑ ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏Ç‡∏≠</h4>
                        <div id="statusChart" class="grid grid-cols-1 md:grid-cols-5 gap-4">
                            <!-- Status chart will be generated here -->
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">üïí ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h4>
                        <div id="recentActivity" class="space-y-3">
                            <!-- Recent activity will be shown here -->
                        </div>
                    </div>
                </div>

                <!-- Users Tab -->
                <div id="usersTabContent" class="admin-tab-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-purple-800">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                        <button onclick="showAddUserForm()" class="bg-green-500 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-600 transition-all duration-200">
                            ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà
                        </button>
                    </div>

                    <!-- Add User Form -->
                    <div id="addUserForm" class="hidden bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6">
                        <h4 class="font-semibold text-gray-800 mb-4">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà</h4>
                        <form id="newUserForm" class="space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Username)</label>
                                    <input type="text" id="newUsername" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password)</label>
                                    <input type="password" id="newPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                                    <input type="text" id="newFullName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</label>
                                    <select id="newRole" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                                        <option value="admin">Admin</option>
                                        <option value="staff">Staff</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex space-x-3">
                                <button type="submit" class="px-6 py-3 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-all duration-200">
                                    ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
                                </button>
                                <button type="button" onclick="hideAddUserForm()" class="px-6 py-3 bg-gray-500 text-white rounded-lg font-medium hover:bg-gray-600 transition-all duration-200">
                                    ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Users List -->
                    <div id="usersList" class="space-y-4">
                        <!-- Users will be loaded here -->
                    </div>
                </div>

                <!-- Google Sheets Tab -->
                <div id="sheetsTabContent" class="admin-tab-content hidden">
                    <h3 class="text-xl font-semibold text-purple-800 mb-6">üìä ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets</h3>
                    
                    <!-- Connection Status -->
                    <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                        <h4 class="font-medium text-gray-800 mb-2">üîó ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h4>
                        <div id="adminConnectionStatus">
                            <div class="flex items-center space-x-2">
                                <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                                <span class="text-yellow-700">Demo Mode - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Console ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span>
                            </div>
                        </div>
                    </div>

                    <!-- Setup Methods -->
                    <div class="grid md:grid-cols-1 gap-6">
                        <!-- Google Apps Script Method -->
                        <div class="border border-gray-200 rounded-lg p-6">
                            <h4 class="text-lg font-semibold text-green-800 mb-4">üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Google Apps Script (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)</h4>
                            
                            <div class="space-y-4">
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <h5 class="font-medium text-blue-800 mb-2">üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:</h5>
                                    <ol class="list-decimal list-inside text-sm text-blue-700 space-y-1">
                                        <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà <a href="https://script.google.com" target="_blank" class="underline hover:text-blue-900">script.google.com</a></li>
                                        <li>‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà" (New Project)</li>
                                        <li>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Code ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Code.gs</li>
                                        <li>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç SPREADSHEET_ID ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</li>
                                        <li>‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy" ‚Üí "New deployment"</li>
                                        <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Type: "Web app"</li>
                                        <li>Execute as: "Me", Who has access: "Anyone"</li>
                                        <li>‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy" ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Web app URL</li>
                                        <li>‡∏ô‡∏≥ URL ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</li>
                                    </ol>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">üìù Google Apps Script Code:</label>
                                    <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 text-xs font-mono overflow-x-auto">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-gray-600">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Code ‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô Google Apps Script</span>
                                            <button onclick="copyGoogleAppsScriptCode()" class="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600">
                                                üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
                                            </button>
                                        </div>
                                        <pre class="text-gray-800 whitespace-pre-wrap">function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const action = data.action;
    
    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô SPREADSHEET_ID ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID_HERE';
    const sheet = SpreadsheetApp.openById(SPREADSHEET_ID).getActiveSheet();
    
    if (action === 'addRow') {
      const rowData = data.data;
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
      if (sheet.getLastRow() === 0) {
        sheet.appendRow([
          '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠', '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠', '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•', '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πà‡∏≤', '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏Å‡πà‡∏≤', '‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠', '‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û', '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô', '‡∏´‡πâ‡∏≠‡∏á', '‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö',
          '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô', '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå', '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£', 
          '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô', '‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î'
        ]);
      }
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      sheet.appendRow([
        rowData.requestId, rowData.titlePrefix, rowData.fullName, rowData.oldTitlePrefix, rowData.oldName, rowData.hasNameChange, rowData.studentId, rowData.studentStatus, rowData.faculty, rowData.room, rowData.graduationYear,
        rowData.documents, rowData.quantity, rowData.purpose, rowData.phone,
        rowData.submitDate, rowData.submitTime, rowData.status,
        new Date().toLocaleString('th-TH')
      ]);
      
      return ContentService
        .createTextOutput(JSON.stringify({success: true, message: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}))
        .setMimeType(ContentService.MimeType.JSON);
        
    } else if (action === 'updateStatus') {
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
      const requestId = data.requestId;
      const newStatus = data.status;
      const updateTime = data.updateTime;
      
      const dataRange = sheet.getDataRange();
      const values = dataRange.getValues();
      
      for (let i = 1; i < values.length; i++) {
        if (values[i][0] === requestId) {
          sheet.getRange(i + 1, 18).setValue(newStatus);
          sheet.getRange(i + 1, 19).setValue(updateTime);
          break;
        }
      }
      
      return ContentService
        .createTextOutput(JSON.stringify({success: true, message: '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}</pre>
                                    </div>
                                </div>

                                <div class="grid md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">üîó Web App URL:</label>
                                        <input type="url" id="adminWebAppUrlInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="https://script.google.com/macros/s/.../exec">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">üìä Spreadsheet ID (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):</label>
                                        <input type="text" id="adminSpreadsheetIdInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms">
                                    </div>
                                </div>

                                <div class="flex space-x-3">
                                    <button onclick="adminTestConnection()" class="px-6 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-all duration-200">
                                        üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                                    </button>
                                    <button onclick="adminSaveGoogleSheetsConfig()" class="px-6 py-3 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-all duration-200">
                                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Help Section -->
                    <div class="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <h5 class="font-medium text-yellow-800 mb-2">üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</h5>
                        <ul class="text-sm text-yellow-700 space-y-1">
                            <li>‚Ä¢ ‡∏´‡∏≤‡∏Å Spreadsheet ID ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ô Google Apps Script</li>
                            <li>‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</li>
                            <li>‚Ä¢ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π Google Sheets ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö Real-time ‡πÑ‡∏î‡πâ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div id="notificationModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-xl p-6 w-96 mx-4 max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-800">üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                <button onclick="hideNotifications()" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            <div id="notificationList" class="space-y-3">
                <div class="text-gray-500 text-center py-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà</div>
            </div>
            <div class="mt-4 flex space-x-2">
                <button onclick="markAllAsRead()" class="flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-blue-600 transition-all duration-200">
                    ‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß
                </button>
                <button onclick="clearAllNotifications()" class="flex-1 bg-gray-500 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-gray-600 transition-all duration-200">
                    üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
            </div>
        </div>
    </div>

        <!-- Admin Login Modal -->
        <div id="adminLoginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
            <div class="bg-white rounded-2xl shadow-xl p-6 w-96 mx-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-gray-800">üë®‚Äçüíº Admin Login</h3>
                    <button onclick="hideAdminLogin()" class="text-gray-500 hover:text-gray-700">‚úï</button>
                </div>
                <form id="adminLoginForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                        <input type="text" id="adminUsername" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="admin" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="adminPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="admin123" required>
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-purple-700 hover:to-indigo-700 transition-all duration-200">
                        üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                    </button>
                </form>
                <div class="mt-4 text-xs text-gray-500 text-center">
                    Demo: username = admin, password = admin123
                </div>
            </div>
        </div>




    <!-- Google Sheets Setup Modal -->
    <div id="googleSheetsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-4xl mx-4 max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-semibold text-gray-800">üìä ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets</h3>
                <button onclick="hideGoogleSheetsSetup()" class="text-gray-500 hover:text-gray-700 text-xl">‚úï</button>
            </div>

            <!-- Connection Status -->
            <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">üîó ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h4>
                <div id="connectionStatus">
                    <div class="flex items-center space-x-2">
                        <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                        <span class="text-yellow-700">Demo Mode - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Console ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span>
                    </div>
                </div>
            </div>

            <!-- Setup Methods -->
            <div class="grid md:grid-cols-1 gap-6">
                <!-- Google Apps Script Method -->
                <div class="border border-gray-200 rounded-lg p-6">
                    <h4 class="text-lg font-semibold text-green-800 mb-4">üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Google Apps Script (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)</h4>
                    
                    <div class="space-y-4">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h5 class="font-medium text-blue-800 mb-2">üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:</h5>
                            <ol class="list-decimal list-inside text-sm text-blue-700 space-y-1">
                                <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà <a href="https://script.google.com" target="_blank" class="underline hover:text-blue-900">script.google.com</a></li>
                                <li>‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà" (New Project)</li>
                                <li>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Code ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Code.gs</li>
                                <li>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç SPREADSHEET_ID ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</li>
                                <li>‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy" ‚Üí "New deployment"</li>
                                <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Type: "Web app"</li>
                                <li>Execute as: "Me", Who has access: "Anyone"</li>
                                <li>‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy" ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Web app URL</li>
                                <li>‡∏ô‡∏≥ URL ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</li>
                            </ol>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üìù Google Apps Script Code:</label>
                            <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 text-xs font-mono overflow-x-auto">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-gray-600">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Code ‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô Google Apps Script</span>
                                    <button onclick="copyGoogleAppsScriptCode()" class="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600">
                                        üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
                                    </button>
                                </div>
                                <pre class="text-gray-800 whitespace-pre-wrap">function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const action = data.action;
    
    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô SPREADSHEET_ID ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID_HERE';
    const sheet = SpreadsheetApp.openById(SPREADSHEET_ID).getActiveSheet();
    
    if (action === 'addRow') {
      const rowData = data.data;
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
      if (sheet.getLastRow() === 0) {
        sheet.appendRow([
          '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠', '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠', '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•', '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πà‡∏≤', '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏Å‡πà‡∏≤', '‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠', '‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô', 
          '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô', '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå', '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£', 
          '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô', '‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î'
        ]);
      }
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      sheet.appendRow([
        rowData.requestId, rowData.titlePrefix, rowData.fullName, rowData.oldTitlePrefix, rowData.oldName, rowData.hasNameChange, rowData.studentId, rowData.faculty,
        rowData.documents, rowData.quantity, rowData.purpose, rowData.phone,
        rowData.submitDate, rowData.submitTime, rowData.status,
        new Date().toLocaleString('th-TH')
      ]);
      
      return ContentService
        .createTextOutput(JSON.stringify({success: true, message: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}))
        .setMimeType(ContentService.MimeType.JSON);
        
    } else if (action === 'updateStatus') {
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
      const requestId = data.requestId;
      const newStatus = data.status;
      const updateTime = data.updateTime;
      
      const dataRange = sheet.getDataRange();
      const values = dataRange.getValues();
      
      for (let i = 1; i < values.length; i++) {
        if (values[i][0] === requestId) {
          sheet.getRange(i + 1, 15).setValue(newStatus);
          sheet.getRange(i + 1, 16).setValue(updateTime);
          break;
        }
      }
      
      return ContentService
        .createTextOutput(JSON.stringify({success: true, message: '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}</pre>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">üîó Web App URL:</label>
                                <input type="url" id="webAppUrlInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="https://script.google.com/macros/s/.../exec">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">üìä Spreadsheet ID (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):</label>
                                <input type="text" id="spreadsheetIdInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms">
                            </div>
                        </div>

                        <div class="flex space-x-3">
                            <button onclick="testConnection()" class="px-6 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-all duration-200">
                                üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                            </button>
                            <button onclick="saveGoogleSheetsConfig()" class="px-6 py-3 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-all duration-200">
                                üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Help Section -->
            <div class="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <h5 class="font-medium text-yellow-800 mb-2">üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</h5>
                <ul class="text-sm text-yellow-700 space-y-1">
                    <li>‚Ä¢ ‡∏´‡∏≤‡∏Å Spreadsheet ID ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ô Google Apps Script</li>
                    <li>‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</li>
                    <li>‚Ä¢ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π Google Sheets ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö Real-time ‡πÑ‡∏î‡πâ</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-xl p-6 w-96 mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-800">üë®‚Äçüíº Admin Login</h3>
                <button onclick="hideAdminLogin()" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            <form id="adminLoginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="adminUsername" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="admin" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="adminPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="admin123" required>
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-purple-700 hover:to-indigo-700 transition-all duration-200">
                    üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </button>
            </form>
            <div class="mt-4 text-xs text-gray-500 text-center">
                Demo: username = admin, password = admin123
            </div>
        </div>
    </div>

    <script>
        let requestCounter = 1;
        let requestDatabase = {}; // Store request data for tracking
        let isAdminLoggedIn = false;
        let notifications = []; // Store notifications
        let notificationCounter = 1;
        let userDatabase = {
            'admin': { username: 'admin', password: 'admin123', fullName: '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö', role: 'admin', createdDate: '2024-01-01' },
            'staff1': { username: 'staff1', password: 'staff123', fullName: '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà 1', role: 'staff', createdDate: '2024-01-15' }
        };

        // Google Sheets Configuration
        let GOOGLE_SHEETS_CONFIG = {
            webAppUrl: 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE',
            spreadsheetId: 'YOUR_SPREADSHEET_ID_HERE'
        };

        // Function to send data to Google Sheets
        async function sendToGoogleSheets(action, data) {
            // If not configured, just log to console
            if (GOOGLE_SHEETS_CONFIG.webAppUrl === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
                console.log('üìä Google Sheets Demo Mode - Data would be sent:', { action, data });
                return { success: true, message: 'Demo mode - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Console' };
            }

            try {
                const response = await fetch(GOOGLE_SHEETS_CONFIG.webAppUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ action, data })
                });

                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Error sending to Google Sheets:', error);
                return { success: false, error: error.message };
            }
        }

        document.getElementById('documentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form data
            const titlePrefix = document.getElementById('titlePrefix').value;
            const fullName = document.getElementById('fullName').value;
            const studentId = document.getElementById('studentId').value;
            const studentStatus = document.querySelector('input[name="studentStatus"]:checked')?.value;
            const faculty = studentStatus === 'current' ? document.getElementById('faculty').value : '';
            const graduationYear = studentStatus === 'alumni' ? document.getElementById('graduationYear').value : '';
            const quantity = document.getElementById('quantity').value;
            const purpose = document.getElementById('purpose').value;
            const purposeDetails = document.getElementById('purposeDetails').value;
            const phone = document.getElementById('phone').value;
            const hasNameChange = document.getElementById('hasNameChange').checked;
            const oldTitlePrefix = hasNameChange ? document.getElementById('oldTitlePrefix').value : '';
            const oldName = hasNameChange ? document.getElementById('oldName').value : '';
            
            // Validate student status
            if (!studentStatus) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û (‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ ‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤)');
                return;
            }
            
            // Validate based on student status
            if (studentStatus === 'current' && !faculty) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô');
                return;
            }
            
            // Validate room for current students
            const room = studentStatus === 'current' ? document.getElementById('room').value : '';
            if (studentStatus === 'current' && faculty && !room) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô');
                return;
            }
            
            if (studentStatus === 'alumni' && !graduationYear) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤');
                return;
            }
            
            // Combine title prefix with full name
            const fullNameWithTitle = `${titlePrefix}${fullName}`;
            const oldNameWithTitle = hasNameChange && oldTitlePrefix && oldName ? `${oldTitlePrefix}${oldName}` : oldName;
            
            // Get selected documents with additional details
            const selectedDocs = [];
            const checkboxes = document.querySelectorAll('input[name="documents"]:checked');
            checkboxes.forEach(checkbox => {
                let docName = checkbox.value;
                const parentLabel = checkbox.closest('label');
                
                // Add graduation year and education level for ‡∏£‡∏ö.1
                if (docName.includes('‡∏£‡∏ö.1')) {
                    const graduationYearInput = parentLabel.querySelector('.graduation-year-input');
                    const selectedLevel = parentLabel.querySelector('.rb1-level-input:checked');
                    
                    let additionalInfo = '';
                    if (selectedLevel && selectedLevel.value) {
                        additionalInfo += selectedLevel.value;
                    }
                    if (graduationYearInput && graduationYearInput.value) {
                        additionalInfo += ` ‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö: ${graduationYearInput.value}`;
                    }
                    if (additionalInfo) {
                        docName += ` (${additionalInfo})`;
                    }
                }
                
                // Add semester details for ‡∏õ‡∏û.6
                if (docName.includes('‡∏õ‡∏û.6')) {
                    const semesterInput = parentLabel.querySelector('.semester-input');
                    const academicYearInput = parentLabel.querySelector('.academic-year-input');
                    if (semesterInput && academicYearInput && semesterInput.value && academicYearInput.value) {
                        docName += ` (‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${semesterInput.value} ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${academicYearInput.value})`;
                    }
                }
                
                // Add custom document name for ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
                if (docName.includes('‡∏≠‡∏∑‡πà‡∏ô ‡πÜ')) {
                    const otherDocumentInput = parentLabel.querySelector('.other-document-input');
                    if (otherDocumentInput && otherDocumentInput.value) {
                        docName = `‡∏≠‡∏∑‡πà‡∏ô ‡πÜ: ${otherDocumentInput.value}`;
                    }
                }
                
                selectedDocs.push(docName);
            });
            
            if (selectedDocs.length === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£');
                return;
            }
            
            // Validate additional fields
            let validationError = '';
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    const parentLabel = checkbox.closest('label');
                    const docName = checkbox.value;
                    
                    // Check ‡∏£‡∏ö.1 graduation year and education level
                    if (docName.includes('‡∏£‡∏ö.1')) {
                        const graduationYearInput = parentLabel.querySelector('.graduation-year-input');
                        const selectedLevel = parentLabel.querySelector('.rb1-level-input:checked');
                        
                        if (!selectedLevel) {
                            validationError = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏£‡∏ö.1';
                        } else if (!graduationYearInput.value) {
                            validationError = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏£‡∏ö.1';
                        }
                    }
                    
                    // Check ‡∏õ‡∏û.6 semester details
                    if (docName.includes('‡∏õ‡∏û.6')) {
                        const semesterInput = parentLabel.querySelector('.semester-input');
                        const academicYearInput = parentLabel.querySelector('.academic-year-input');
                        if (!semesterInput.value || !academicYearInput.value) {
                            validationError = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏õ‡∏û.6';
                        }
                    }
                    
                    // Check ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ document specification
                    if (docName.includes('‡∏≠‡∏∑‡πà‡∏ô ‡πÜ')) {
                        const otherDocumentInput = parentLabel.querySelector('.other-document-input');
                        if (!otherDocumentInput.value) {
                            validationError = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏≠‡∏∑‡πà‡∏ô ‡πÜ"';
                        }
                    }
                }
            });
            
            // Validate purpose details
            if (purpose === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' && !purposeDetails.trim()) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"');
                return;
            }
            
            if (validationError) {
                alert(validationError);
                return;
            }
            
            // Create request
            const requestId = `REQ${String(requestCounter).padStart(4, '0')}`;
            const currentDate = new Date().toLocaleDateString('th-TH');
            const currentTime = new Date().toLocaleTimeString('th-TH', {hour: '2-digit', minute: '2-digit'});
            
            // Store request data for tracking
            requestDatabase[requestId] = {
                id: requestId,
                titlePrefix: titlePrefix,
                fullName: fullNameWithTitle,
                oldTitlePrefix: oldTitlePrefix,
                oldName: oldNameWithTitle,
                hasNameChange: hasNameChange,
                studentId: studentId,
                studentStatus: studentStatus,
                faculty: faculty,
                room: room,
                graduationYear: graduationYear,
                documents: selectedDocs,
                quantity: quantity,
                purpose: purpose === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? `‡∏≠‡∏∑‡πà‡∏ô‡πÜ: ${purposeDetails}` : purpose,
                phone: phone,
                submitDate: currentDate,
                submitTime: currentTime,
                status: 'submitted',
                progress: [
                    {step: '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠', status: 'completed', time: `${currentDate} ${currentTime}`, description: '‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß'},
                    {step: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', status: 'pending', time: '', description: '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'},
                    {step: '‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£', status: 'pending', time: '', description: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠'},
                    {step: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£', status: 'pending', time: '', description: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ó‡∏≥'},
                    {step: '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£', status: 'pending', time: '', description: '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≠‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£'}
                ]
            };

            // Send data to Google Sheets
            const sheetsData = {
                requestId: requestId,
                titlePrefix: titlePrefix,
                fullName: fullNameWithTitle,
                oldTitlePrefix: oldTitlePrefix,
                oldName: oldNameWithTitle,
                hasNameChange: hasNameChange ? '‡πÄ‡∏Ñ‡∏¢' : '‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢',
                studentId: studentId,
                studentStatus: studentStatus === 'current' ? '‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô' : '‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤',
                faculty: faculty,
                room: room,
                graduationYear: graduationYear,
                documents: selectedDocs.join(', '),
                quantity: quantity,
                purpose: purpose === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? `‡∏≠‡∏∑‡πà‡∏ô‡πÜ: ${purposeDetails}` : purpose,
                phone: phone,
                submitDate: currentDate,
                submitTime: currentTime,
                status: '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÅ‡∏•‡πâ‡∏ß'
            };

            sendToGoogleSheets('addRow', sheetsData).then(result => {
                if (result.success) {
                    console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                } else {
                    console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏õ Google Sheets:', result.error);
                }
            });
            
            // Add to request list
            addRequestToList(requestId, fullNameWithTitle, selectedDocs, quantity, currentDate);
            
            // Create notification for admin
            addNotification({
                id: `NOTIF${String(notificationCounter).padStart(4, '0')}`,
                type: 'new_request',
                title: 'üìã ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà',
                message: `${fullNameWithTitle} ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ${requestId}`,
                requestId: requestId,
                timestamp: new Date().toLocaleString('th-TH'),
                isRead: false
            });
            notificationCounter++;
            
            // Reset form
            this.reset();
            
            // Show success message and redirect to tracking page
            alert(`‚úÖ ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠: ${requestId}\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏à‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ`);
            
            // Update admin panel if logged in
            if (isAdminLoggedIn) {
                loadAdminRequests();
            }
            
            // Update notification display
            updateNotificationDisplay();
            
            // Redirect to tracking page and auto-fill the request ID
            showTrackingPage();
            document.getElementById('trackingInput').value = requestId;
            
            requestCounter++;
        });

        function addRequestToList(requestId, fullName, documents, quantity, date) {
            const requestList = document.getElementById('requestList');
            
            // Remove empty message if exists
            if (requestList.querySelector('.text-gray-500')) {
                requestList.innerHTML = '';
            }
            
            const requestItem = document.createElement('div');
            requestItem.className = 'bg-gray-50 border border-gray-200 rounded-lg p-4';
            
            const statusColor = 'text-yellow-600';
            const statusBg = 'bg-yellow-100';
            const statusText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
            
            requestItem.innerHTML = `
                <div class="flex justify-between items-start mb-2">
                    <div class="font-semibold text-gray-800">${requestId}</div>
                    <span class="px-2 py-1 ${statusBg} ${statusColor} text-xs rounded-full">${statusText}</span>
                </div>
                <div class="text-sm text-gray-600 mb-2">
                    <div><strong>‡∏ú‡∏π‡πâ‡∏Ç‡∏≠:</strong> ${fullName}</div>
                    <div><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô:</strong> ${date}</div>
                </div>
                <div class="text-sm text-gray-700">
                    <div><strong>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</strong></div>
                    <ul class="list-disc list-inside ml-2">
                        ${documents.map(doc => `<li>${doc} (${quantity} ‡∏â‡∏ö‡∏±‡∏ö)</li>`).join('')}
                    </ul>
                </div>
                <div class="mt-3 flex space-x-2">
                    <button onclick="updateStatus('${requestId}', 'ready')" class="px-3 py-1 bg-green-100 text-green-700 text-xs rounded hover:bg-green-200">
                        ‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö
                    </button>
                    <button onclick="updateStatus('${requestId}', 'completed')" class="px-3 py-1 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200">
                        üìã ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß
                    </button>
                </div>
            `;
            
            requestList.appendChild(requestItem);
        }

        function updateStatus(requestId, status) {
            const requestItems = document.querySelectorAll('#requestList > div');
            
            requestItems.forEach(item => {
                const idElement = item.querySelector('.font-semibold');
                if (idElement && idElement.textContent === requestId) {
                    const statusElement = item.querySelector('.px-2.py-1');
                    
                    if (status === 'ready') {
                        statusElement.className = 'px-2 py-1 bg-green-100 text-green-600 text-xs rounded-full';
                        statusElement.textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö';
                    } else if (status === 'completed') {
                        statusElement.className = 'px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full';
                        statusElement.textContent = '‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß';
                        
                        // Hide action buttons
                        const buttons = item.querySelector('.mt-3');
                        if (buttons) buttons.style.display = 'none';
                    }
                }
            });
        }

        function searchRequests() {
            const searchTerm = document.getElementById('trackingInput').value.trim();
            const searchResults = document.getElementById('searchResults');
            const trackingResult = document.getElementById('trackingResult');

            if (!searchTerm) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
                return;
            }

            // Hide previous results
            searchResults.classList.add('hidden');
            trackingResult.classList.add('hidden');

            // Search through all requests
            const matchingRequests = [];
            
            Object.values(requestDatabase).forEach(request => {
                const searchTermLower = searchTerm.toLowerCase();
                const fullNameLower = request.fullName.toLowerCase();
                const requestIdLower = request.id.toLowerCase();
                const studentIdLower = request.studentId.toLowerCase();
                
                // Check if search term matches any field
                if (requestIdLower.includes(searchTermLower) ||
                    fullNameLower.includes(searchTermLower) ||
                    studentIdLower.includes(searchTermLower)) {
                    matchingRequests.push(request);
                }
            });

            if (matchingRequests.length === 0) {
                alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
                return;
            }

            if (matchingRequests.length === 1) {
                // Show single result in detailed view
                showSingleRequestDetails(matchingRequests[0]);
            } else {
                // Show multiple results
                showMultipleSearchResults(matchingRequests, searchTerm);
            }
        }

        function showSingleRequestDetails(request) {
            const trackingResult = document.getElementById('trackingResult');
            const trackingTitle = document.getElementById('trackingTitle');
            const progressSteps = document.getElementById('progressSteps');

            // Show tracking result
            trackingResult.classList.remove('hidden');
            trackingTitle.textContent = `‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏Ç‡∏≠: ${request.id}`;

            // Clear previous steps
            progressSteps.innerHTML = '';

            // Display progress steps
            request.progress.forEach((step, index) => {
                const stepElement = document.createElement('div');
                stepElement.className = 'flex items-start space-x-3';

                let statusIcon = '';
                let statusColor = '';
                
                if (step.status === 'completed') {
                    statusIcon = '‚úÖ';
                    statusColor = 'text-green-600';
                } else if (step.status === 'in-progress') {
                    statusIcon = 'üîÑ';
                    statusColor = 'text-blue-600';
                } else {
                    statusIcon = '‚è≥';
                    statusColor = 'text-gray-400';
                }

                stepElement.innerHTML = `
                    <div class="flex-shrink-0 text-lg">${statusIcon}</div>
                    <div class="flex-1">
                        <div class="font-medium ${statusColor}">${step.step}</div>
                        <div class="text-sm text-gray-600">${step.description}</div>
                        ${step.time ? `<div class="text-xs text-gray-500 mt-1">‚è∞ ${step.time}</div>` : ''}
                    </div>
                `;

                progressSteps.appendChild(stepElement);
            });

            // Add request details
            const detailsElement = document.createElement('div');
            detailsElement.className = 'mt-4 pt-4 border-t border-pink-200';
            detailsElement.innerHTML = `
                <h5 class="font-medium text-pink-800 mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏Ç‡∏≠</h5>
                <div class="text-sm text-gray-600 space-y-1">
                    <div><strong>‡∏ú‡∏π‡πâ‡∏Ç‡∏≠:</strong> ${request.fullName}</div>
                    ${request.hasNameChange ? `<div><strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏Å‡πà‡∏≤:</strong> ${request.oldName}</div>` : ''}
                    <div><strong>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</strong> ${request.studentId}</div>
                    <div><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û:</strong> ${request.studentStatus === 'current' ? 'üéì ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô' : 'üë®‚Äçüéì ‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤'}</div>
                    ${request.studentStatus === 'current' && request.faculty ? `<div><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô:</strong> ${request.faculty}${request.room ? `/${request.room}` : ''}</div>` : ''}
                    ${request.studentStatus === 'alumni' && request.graduationYear ? `<div><strong>‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö:</strong> ${request.graduationYear}</div>` : ''}
                    <div><strong>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠:</strong></div>
                    <ul class="list-disc list-inside ml-4">
                        ${request.documents.map(doc => `<li>${doc} (${request.quantity} ‡∏â‡∏ö‡∏±‡∏ö)</li>`).join('')}
                    </ul>
                    <div><strong>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</strong> ${request.purpose}</div>
                </div>
            `;
            progressSteps.appendChild(detailsElement);
        }

        function showMultipleSearchResults(requests, searchTerm) {
            const searchResults = document.getElementById('searchResults');
            
            searchResults.classList.remove('hidden');
            searchResults.innerHTML = `
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                    <h4 class="font-semibold text-blue-800 mb-4 text-center text-xl">
                        üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "${searchTerm}" (‡∏û‡∏ö ${requests.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
                    </h4>
                    <div class="space-y-4" id="multipleResultsList">
                        <!-- Results will be inserted here -->
                    </div>
                </div>
            `;

            const resultsList = document.getElementById('multipleResultsList');
            
            requests.forEach(request => {
                // Get current step
                let currentStep = '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠';
                let currentStepIndex = 0;
                request.progress.forEach((step, index) => {
                    if (step.status === 'completed' || step.status === 'in-progress') {
                        currentStep = step.step;
                        currentStepIndex = index;
                    }
                });

                const resultElement = document.createElement('div');
                resultElement.className = 'bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200 cursor-pointer';
                resultElement.onclick = () => showSingleRequestDetails(request);
                
                resultElement.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h5 class="font-semibold text-gray-800 text-lg">${request.id}</h5>
                            <p class="text-sm text-gray-600">üë§ ${request.fullName} (${request.studentId})</p>
                            <p class="text-sm text-gray-600">üìÖ ‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${request.submitDate}</p>
                        </div>
                        <div class="text-right">
                            <span class="px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full">
                                ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà ${currentStepIndex + 1}: ${currentStep}
                            </span>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <p class="text-sm text-gray-700"><strong>üìÑ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</strong></p>
                        <ul class="list-disc list-inside text-sm text-gray-600 ml-2">
                            ${request.documents.map(doc => `<li>${doc} (${request.quantity} ‡∏â‡∏ö‡∏±‡∏ö)</li>`).join('')}
                        </ul>
                    </div>

                    <div class="text-center">
                        <button class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            üëÅÔ∏è ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏ï‡πá‡∏°
                        </button>
                    </div>
                `;
                
                resultsList.appendChild(resultElement);
            });
        }

        // Keep the old function for backward compatibility
        function trackRequest() {
            searchRequests();
        }

        // Google Sheets Setup Functions
        function showGoogleSheetsSetup() {
            document.getElementById('googleSheetsModal').classList.remove('hidden');
            updateConnectionStatus();
        }

        function hideGoogleSheetsSetup() {
            document.getElementById('googleSheetsModal').classList.add('hidden');
        }

        function updateConnectionStatus() {
            const statusDiv = document.getElementById('connectionStatus');
            const isConfigured = GOOGLE_SHEETS_CONFIG.webAppUrl !== 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE';
            
            if (isConfigured) {
                statusDiv.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                        <span class="text-green-700">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets</span>
                    </div>
                `;
            } else {
                statusDiv.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                        <span class="text-yellow-700">Demo Mode - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Console ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span>
                    </div>
                `;
            }
        }

        function copyGoogleAppsScriptCode() {
            const code = `function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const action = data.action;
    
    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô SPREADSHEET_ID ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID_HERE';
    const sheet = SpreadsheetApp.openById(SPREADSHEET_ID).getActiveSheet();
    
    if (action === 'addRow') {
      const rowData = data.data;
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
      if (sheet.getLastRow() === 0) {
        sheet.appendRow([
          '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠', '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠', '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•', '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πà‡∏≤', '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏Å‡πà‡∏≤', '‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠', '‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û', '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô', '‡∏´‡πâ‡∏≠‡∏á', '‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö',
          '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô', '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå', '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£', 
          '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô', '‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î'
        ]);
      }
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      sheet.appendRow([
        rowData.requestId,
        rowData.titlePrefix,
        rowData.fullName,
        rowData.oldTitlePrefix,
        rowData.oldName,
        rowData.hasNameChange,
        rowData.studentId,
        rowData.studentStatus,
        rowData.faculty,
        rowData.room,
        rowData.graduationYear,
        rowData.documents,
        rowData.quantity,
        rowData.purpose,
        rowData.phone,
        rowData.submitDate,
        rowData.submitTime,
        rowData.status,
        new Date().toLocaleString('th-TH')
      ]);
      
      return ContentService
        .createTextOutput(JSON.stringify({success: true, message: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}))
        .setMimeType(ContentService.MimeType.JSON);
        
    } else if (action === 'updateStatus') {
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
      const requestId = data.requestId;
      const newStatus = data.status;
      const stepCompleted = data.stepCompleted;
      const updateTime = data.updateTime;
      
      const dataRange = sheet.getDataRange();
      const values = dataRange.getValues();
      
      for (let i = 1; i < values.length; i++) {
        if (values[i][0] === requestId) {
          sheet.getRange(i + 1, 18).setValue(newStatus); // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
          sheet.getRange(i + 1, 19).setValue(updateTime); // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
          break;
        }
      }
      
      return ContentService
        .createTextOutput(JSON.stringify({success: true, message: '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}`;

            navigator.clipboard.writeText(code).then(() => {
                alert('üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Google Apps Script Code ‡πÅ‡∏•‡πâ‡∏ß!\n\n‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Code.gs ‡πÉ‡∏ô Google Apps Script');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = code;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Google Apps Script Code ‡πÅ‡∏•‡πâ‡∏ß!');
            });
        }

        function testConnection() {
            const webAppUrl = document.getElementById('webAppUrlInput').value.trim();
            
            if (!webAppUrl) {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Web App URL ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                return;
            }

            // Test connection with sample data
            const testData = {
                action: 'addRow',
                data: {
                    requestId: 'TEST001',
                    fullName: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö',
                    studentId: '00000',
                    faculty: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
                    documents: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠',
                    quantity: '1',
                    purpose: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
                    phone: '000-000-0000',
                    submitDate: new Date().toLocaleDateString('th-TH'),
                    submitTime: new Date().toLocaleTimeString('th-TH'),
                    status: 'test'
                }
            };

            fetch(webAppUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(testData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert('‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏õ Google Sheets ‡πÅ‡∏•‡πâ‡∏ß');
                } else {
                    alert('‚ùå ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ' + (result.error || 'Unknown error'));
                }
            })
            .catch(error => {
                alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ' + error.message);
            });
        }

        function saveGoogleSheetsConfig() {
            const webAppUrl = document.getElementById('webAppUrlInput').value.trim();
            const spreadsheetId = document.getElementById('spreadsheetIdInput').value.trim();

            if (!webAppUrl && !spreadsheetId) {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
                return;
            }

            // Update configuration
            if (webAppUrl) {
                GOOGLE_SHEETS_CONFIG.webAppUrl = webAppUrl;
            }
            if (spreadsheetId) {
                GOOGLE_SHEETS_CONFIG.spreadsheetId = spreadsheetId;
            }

            // Save to localStorage for persistence
            localStorage.setItem('googleSheetsConfig', JSON.stringify(GOOGLE_SHEETS_CONFIG));

            updateConnectionStatus();
            alert('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets ‡πÅ‡∏•‡πâ‡∏ß');
        }

        // Load saved configuration on page load
        function loadSavedConfig() {
            const saved = localStorage.getItem('googleSheetsConfig');
            if (saved) {
                const config = JSON.parse(saved);
                Object.assign(GOOGLE_SHEETS_CONFIG, config);
                
                // Update input fields
                if (config.webAppUrl) {
                    document.getElementById('webAppUrlInput').value = config.webAppUrl;
                }
                if (config.spreadsheetId) {
                    document.getElementById('spreadsheetIdInput').value = config.spreadsheetId;
                }
            }
        }

        // Load configuration when page loads
        window.addEventListener('load', loadSavedConfig);

        // Admin Google Sheets Functions
        function loadAdminGoogleSheetsConfig() {
            updateAdminConnectionStatus();
            
            // Load saved configuration into admin inputs
            if (GOOGLE_SHEETS_CONFIG.webAppUrl && GOOGLE_SHEETS_CONFIG.webAppUrl !== 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
                document.getElementById('adminWebAppUrlInput').value = GOOGLE_SHEETS_CONFIG.webAppUrl;
            }
            if (GOOGLE_SHEETS_CONFIG.spreadsheetId && GOOGLE_SHEETS_CONFIG.spreadsheetId !== 'YOUR_SPREADSHEET_ID_HERE') {
                document.getElementById('adminSpreadsheetIdInput').value = GOOGLE_SHEETS_CONFIG.spreadsheetId;
            }
        }

        function updateAdminConnectionStatus() {
            const statusDiv = document.getElementById('adminConnectionStatus');
            const isConfigured = GOOGLE_SHEETS_CONFIG.webAppUrl !== 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE';
            
            if (isConfigured) {
                statusDiv.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                        <span class="text-green-700">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets</span>
                    </div>
                `;
            } else {
                statusDiv.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <span class="w-3 h-3 bg-yellow-500 rounded-full"></span>
                        <span class="text-yellow-700">Demo Mode - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Console ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span>
                    </div>
                `;
            }
        }

        function adminTestConnection() {
            const webAppUrl = document.getElementById('adminWebAppUrlInput').value.trim();
            
            if (!webAppUrl) {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Web App URL ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                return;
            }

            // Test connection with sample data
            const testData = {
                action: 'addRow',
                data: {
                    requestId: 'TEST001',
                    fullName: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö',
                    studentId: '00000',
                    faculty: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
                    documents: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠',
                    quantity: '1',
                    purpose: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
                    phone: '000-000-0000',
                    submitDate: new Date().toLocaleDateString('th-TH'),
                    submitTime: new Date().toLocaleTimeString('th-TH'),
                    status: 'test'
                }
            };

            fetch(webAppUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(testData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert('‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏õ Google Sheets ‡πÅ‡∏•‡πâ‡∏ß');
                } else {
                    alert('‚ùå ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ' + (result.error || 'Unknown error'));
                }
            })
            .catch(error => {
                alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ' + error.message);
            });
        }

        function adminSaveGoogleSheetsConfig() {
            const webAppUrl = document.getElementById('adminWebAppUrlInput').value.trim();
            const spreadsheetId = document.getElementById('adminSpreadsheetIdInput').value.trim();

            if (!webAppUrl && !spreadsheetId) {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
                return;
            }

            // Update configuration
            if (webAppUrl) {
                GOOGLE_SHEETS_CONFIG.webAppUrl = webAppUrl;
            }
            if (spreadsheetId) {
                GOOGLE_SHEETS_CONFIG.spreadsheetId = spreadsheetId;
            }

            // Save to localStorage for persistence
            localStorage.setItem('googleSheetsConfig', JSON.stringify(GOOGLE_SHEETS_CONFIG));

            updateAdminConnectionStatus();
            alert('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets ‡πÅ‡∏•‡πâ‡∏ß');
        }

        // Toggle grade level field based on student status
        function toggleGradeLevel() {
            const currentStudent = document.getElementById('currentStudent').checked;
            const alumniStudent = document.getElementById('alumniStudent').checked;
            const gradeLevelField = document.getElementById('gradeLevelField');
            const graduationYearField = document.getElementById('graduationYearField');
            const facultySelect = document.getElementById('faculty');
            const roomSelect = document.getElementById('room');
            const roomField = document.getElementById('roomField');
            const graduationYearInput = document.getElementById('graduationYear');
            
            if (currentStudent) {
                // Show grade level field for current students
                gradeLevelField.classList.remove('hidden');
                graduationYearField.classList.add('hidden');
                facultySelect.required = true;
                graduationYearInput.required = false;
                graduationYearInput.value = '';
                // Reset room selection
                roomField.classList.add('hidden');
                roomSelect.required = false;
                roomSelect.value = '';
            } else if (alumniStudent) {
                // Show graduation year field for alumni
                gradeLevelField.classList.add('hidden');
                graduationYearField.classList.remove('hidden');
                facultySelect.required = false;
                facultySelect.value = '';
                graduationYearInput.required = true;
                // Hide room field
                roomField.classList.add('hidden');
                roomSelect.required = false;
                roomSelect.value = '';
            } else {
                // Hide both fields if nothing is selected
                gradeLevelField.classList.add('hidden');
                graduationYearField.classList.add('hidden');
                facultySelect.required = false;
                graduationYearInput.required = false;
                facultySelect.value = '';
                graduationYearInput.value = '';
                // Hide room field
                roomField.classList.add('hidden');
                roomSelect.required = false;
                roomSelect.value = '';
            }
        }

        // Toggle room selection based on grade level
        function toggleRoomSelection() {
            const facultySelect = document.getElementById('faculty');
            const roomField = document.getElementById('roomField');
            const roomSelect = document.getElementById('room');
            
            if (facultySelect.value) {
                // Show room field when grade level is selected
                roomField.classList.remove('hidden');
                roomSelect.required = true;
            } else {
                // Hide room field when no grade level is selected
                roomField.classList.add('hidden');
                roomSelect.required = false;
                roomSelect.value = '';
            }
        }

        // Toggle old name field
        function toggleOldNameField() {
            const hasNameChange = document.getElementById('hasNameChange').checked;
            const oldNameField = document.getElementById('oldNameField');
            const oldNameInput = document.getElementById('oldName');
            const oldTitlePrefixInput = document.getElementById('oldTitlePrefix');
            
            if (hasNameChange) {
                oldNameField.classList.remove('hidden');
                oldNameInput.required = true;
                oldTitlePrefixInput.required = true;
            } else {
                oldNameField.classList.add('hidden');
                oldNameInput.required = false;
                oldTitlePrefixInput.required = false;
                oldNameInput.value = '';
                oldTitlePrefixInput.value = '';
            }
        }

        // Toggle ‡∏£‡∏ö.1 details field
        function toggleRb1Details(checkbox) {
            const parentLabel = checkbox.closest('label');
            const rb1DetailsField = parentLabel.querySelector('.rb1-details-field');
            const graduationYearInput = parentLabel.querySelector('.graduation-year-input');
            const rb1LevelInputs = parentLabel.querySelectorAll('.rb1-level-input');
            
            if (checkbox.checked) {
                rb1DetailsField.classList.remove('hidden');
                graduationYearInput.required = true;
                rb1LevelInputs.forEach(input => input.required = true);
            } else {
                rb1DetailsField.classList.add('hidden');
                graduationYearInput.required = false;
                graduationYearInput.value = '';
                rb1LevelInputs.forEach(input => {
                    input.required = false;
                    input.checked = false;
                });
            }
        }

        // Toggle semester details field for ‡∏õ‡∏û.6
        function toggleSemesterDetails(checkbox) {
            const parentLabel = checkbox.closest('label');
            const semesterDetailsField = parentLabel.querySelector('.semester-details-field');
            const semesterInput = parentLabel.querySelector('.semester-input');
            const academicYearInput = parentLabel.querySelector('.academic-year-input');
            
            if (checkbox.checked) {
                semesterDetailsField.classList.remove('hidden');
                semesterInput.required = true;
                academicYearInput.required = true;
            } else {
                semesterDetailsField.classList.add('hidden');
                semesterInput.required = false;
                academicYearInput.required = false;
                semesterInput.value = '';
                academicYearInput.value = '';
            }
        }

        // Toggle other document field
        function toggleOtherDocument(checkbox) {
            const parentLabel = checkbox.closest('label');
            const otherDocumentField = parentLabel.querySelector('.other-document-field');
            const otherDocumentInput = parentLabel.querySelector('.other-document-input');
            
            if (checkbox.checked) {
                otherDocumentField.classList.remove('hidden');
                otherDocumentInput.required = true;
            } else {
                otherDocumentField.classList.add('hidden');
                otherDocumentInput.required = false;
                otherDocumentInput.value = '';
            }
        }

        // Toggle purpose details field
        function togglePurposeDetails() {
            const purposeSelect = document.getElementById('purpose');
            const purposeDetailsField = document.getElementById('purposeDetailsField');
            const purposeDetailsInput = document.getElementById('purposeDetails');
            
            if (purposeSelect.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                purposeDetailsField.classList.remove('hidden');
                purposeDetailsInput.required = true;
            } else {
                purposeDetailsField.classList.add('hidden');
                purposeDetailsInput.required = false;
                purposeDetailsInput.value = '';
            }
        }

        // Page Navigation Functions
        function showSubmitPage() {
            document.getElementById('mainPage').classList.add('hidden');
            document.getElementById('submitPage').classList.remove('hidden');
            document.getElementById('trackingPage').classList.add('hidden');
            document.getElementById('adminPage').classList.add('hidden');
        }

        function showTrackingPage() {
            document.getElementById('mainPage').classList.add('hidden');
            document.getElementById('submitPage').classList.add('hidden');
            document.getElementById('trackingPage').classList.remove('hidden');
            document.getElementById('adminPage').classList.add('hidden');
        }

        function goBackToMenu() {
            document.getElementById('mainPage').classList.remove('hidden');
            document.getElementById('submitPage').classList.add('hidden');
            document.getElementById('trackingPage').classList.add('hidden');
            document.getElementById('adminPage').classList.add('hidden');
        }

        // Admin Functions
        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('hidden');
        }

        function hideAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('hidden');
        }

        document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            // Check against user database
            const user = userDatabase[username];
            if (user && user.password === password) {
                isAdminLoggedIn = true;
                hideAdminLogin();
                showAdminPage();
                loadAdminRequests();
                loadUsersList();
                alert(`‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ${user.fullName}`);
            } else {
                alert('‚ùå Username ‡∏´‡∏£‡∏∑‡∏≠ Password ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
            }
        });

        function showAdminPage() {
            document.getElementById('mainPage').classList.add('hidden');
            document.getElementById('adminPage').classList.remove('hidden');
            updateNotificationDisplay();
        }

        function hideAdminPage() {
            document.getElementById('adminPage').classList.add('hidden');
            document.getElementById('mainPage').classList.remove('hidden');
            updateNotificationDisplay();
        }

        function goBackToMain() {
            goBackToMenu();
        }

        function adminLogout() {
            isAdminLoggedIn = false;
            hideAdminPage();
            updateNotificationDisplay();
            alert('üëã ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö Admin ‡πÅ‡∏•‡πâ‡∏ß');
        }

        // Notification Functions
        function addNotification(notification) {
            notifications.unshift(notification); // Add to beginning of array
            updateNotificationDisplay();
        }

        function updateNotificationDisplay() {
            const adminNotificationBell = document.getElementById('adminNotificationBell');
            const adminNotificationBadge = document.getElementById('adminNotificationBadge');
            
            if (isAdminLoggedIn) {
                const unreadCount = notifications.filter(n => !n.isRead).length;
                if (unreadCount > 0) {
                    adminNotificationBadge.classList.remove('hidden');
                    adminNotificationBadge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                    
                    // Add pulsing animation for new notifications
                    adminNotificationBell.classList.add('animate-pulse');
                    setTimeout(() => {
                        adminNotificationBell.classList.remove('animate-pulse');
                    }, 3000);
                } else {
                    adminNotificationBadge.classList.add('hidden');
                }
            }
        }

        function showNotifications() {
            document.getElementById('notificationModal').classList.remove('hidden');
            loadNotifications();
        }

        function hideNotifications() {
            document.getElementById('notificationModal').classList.add('hidden');
        }

        function loadNotifications() {
            const notificationList = document.getElementById('notificationList');
            
            if (notifications.length === 0) {
                notificationList.innerHTML = '<div class="text-gray-500 text-center py-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà</div>';
                return;
            }

            notificationList.innerHTML = '';
            
            notifications.forEach(notification => {
                const notificationElement = document.createElement('div');
                notificationElement.className = `border rounded-lg p-3 cursor-pointer hover:bg-gray-50 ${
                    notification.isRead ? 'bg-gray-50 border-gray-200' : 'bg-blue-50 border-blue-200'
                }`;
                
                notificationElement.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-gray-800 text-sm">${notification.title}</h4>
                        <div class="flex items-center space-x-2">
                            ${!notification.isRead ? '<span class="w-2 h-2 bg-blue-500 rounded-full"></span>' : ''}
                            <button onclick="deleteNotification('${notification.id}')" class="text-red-500 hover:text-red-700 text-xs">üóëÔ∏è</button>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm mb-2">${notification.message}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-xs text-gray-500">‚è∞ ${notification.timestamp}</span>
                        ${notification.requestId ? `<button onclick="viewRequestFromNotification('${notification.requestId}')" class="text-blue-600 hover:text-blue-800 text-xs font-medium">üëÅÔ∏è ‡∏î‡∏π‡∏Ñ‡∏≥‡∏Ç‡∏≠</button>` : ''}
                    </div>
                `;
                
                // Mark as read when clicked
                notificationElement.addEventListener('click', () => {
                    if (!notification.isRead) {
                        notification.isRead = true;
                        updateNotificationDisplay();
                        loadNotifications();
                    }
                });
                
                notificationList.appendChild(notificationElement);
            });
        }

        function markAllAsRead() {
            notifications.forEach(notification => {
                notification.isRead = true;
            });
            updateNotificationDisplay();
            loadNotifications();
            alert('‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
        }

        function clearAllNotifications() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                notifications = [];
                updateNotificationDisplay();
                loadNotifications();
                alert('üóëÔ∏è ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        function deleteNotification(notificationId) {
            notifications = notifications.filter(n => n.id !== notificationId);
            updateNotificationDisplay();
            loadNotifications();
        }

        function viewRequestFromNotification(requestId) {
            hideNotifications();
            
            // Make sure we're on admin page and requests tab
            if (!document.getElementById('adminPage').classList.contains('hidden')) {
                showAdminTab('requests');
            } else {
                // If not on admin page, go there first
                showAdminPage();
                showAdminTab('requests');
            }
            
            // Highlight the specific request
            setTimeout(() => {
                const requestElements = document.querySelectorAll('#adminRequestList > div');
                requestElements.forEach(element => {
                    const titleElement = element.querySelector('h4');
                    if (titleElement && titleElement.textContent === requestId) {
                        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        element.style.border = '2px solid #3B82F6';
                        element.style.backgroundColor = '#EFF6FF';
                        
                        setTimeout(() => {
                            element.style.border = '';
                            element.style.backgroundColor = '';
                        }, 3000);
                    }
                });
            }, 100);
        }

        // Admin Tab Functions
        function showAdminTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Reset all tab buttons
            document.getElementById('requestsTab').className = 'px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition-all duration-200';
            document.getElementById('statisticsTab').className = 'px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition-all duration-200';
            document.getElementById('usersTab').className = 'px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition-all duration-200';
            document.getElementById('sheetsTab').className = 'px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition-all duration-200';
            
            // Show selected tab content and highlight button
            if (tabName === 'requests') {
                document.getElementById('requestsTabContent').classList.remove('hidden');
                document.getElementById('requestsTab').className = 'px-6 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-all duration-200';
                loadAdminRequests();
            } else if (tabName === 'statistics') {
                document.getElementById('statisticsTabContent').classList.remove('hidden');
                document.getElementById('statisticsTab').className = 'px-6 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-all duration-200';
                loadStatistics();
            } else if (tabName === 'users') {
                document.getElementById('usersTabContent').classList.remove('hidden');
                document.getElementById('usersTab').className = 'px-6 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-all duration-200';
                loadUsersList();
            } else if (tabName === 'sheets') {
                document.getElementById('sheetsTabContent').classList.remove('hidden');
                document.getElementById('sheetsTab').className = 'px-6 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-all duration-200';
                loadAdminGoogleSheetsConfig();
            }
        }

        // User Management Functions
        function showAddUserForm() {
            document.getElementById('addUserForm').classList.remove('hidden');
        }

        function hideAddUserForm() {
            document.getElementById('addUserForm').classList.add('hidden');
            document.getElementById('newUserForm').reset();
        }

        document.getElementById('newUserForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;
            const fullName = document.getElementById('newFullName').value;
            const role = document.getElementById('newRole').value;
            
            // Check if username already exists
            if (userDatabase[username]) {
                alert('‚ùå ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß');
                return;
            }
            
            // Add new user
            userDatabase[username] = {
                username: username,
                password: password,
                fullName: fullName,
                role: role,
                createdDate: new Date().toLocaleDateString('th-TH')
            };
            
            // Reset form and hide
            hideAddUserForm();
            
            // Reload users list
            loadUsersList();
            
            alert(`‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ "${fullName}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\nUsername: ${username}\nPassword: ${password}`);
        });

        function loadUsersList() {
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '';
            
            Object.values(userDatabase).forEach(user => {
                const userElement = document.createElement('div');
                userElement.className = 'bg-white border border-gray-200 rounded-lg p-4';
                
                const roleColor = user.role === 'admin' ? 'bg-red-100 text-red-700' : 'bg-blue-100 text-blue-700';
                const roleIcon = user.role === 'admin' ? 'üëë' : 'üë§';
                
                userElement.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="font-semibold text-gray-800 flex items-center">
                                ${roleIcon} ${user.fullName}
                            </h4>
                            <p class="text-sm text-gray-600">Username: ${user.username}</p>
                            <p class="text-sm text-gray-600">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${user.createdDate}</p>
                        </div>
                        <div class="text-right">
                            <span class="px-2 py-1 ${roleColor} text-xs rounded-full font-medium">
                                ${user.role.toUpperCase()}
                            </span>
                        </div>
                    </div>
                    
                    <div class="flex space-x-2">
                        <button onclick="editUser('${user.username}')" class="px-3 py-1 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600">
                            ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        </button>
                        <button onclick="resetUserPassword('${user.username}')" class="px-3 py-1 bg-orange-500 text-white text-xs rounded hover:bg-orange-600">
                            üîë ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
                        </button>
                        ${user.username !== 'admin' ? `<button onclick="deleteUser('${user.username}')" class="px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600">
                            üóëÔ∏è ‡∏•‡∏ö
                        </button>` : ''}
                    </div>
                `;
                
                usersList.appendChild(userElement);
            });
        }

        function editUser(username) {
            const user = userDatabase[username];
            if (!user) return;
            
            const newFullName = prompt('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:', user.fullName);
            if (newFullName && newFullName.trim() !== '') {
                user.fullName = newFullName.trim();
                loadUsersList();
                alert('‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            }
        }

        function resetUserPassword(username) {
            const user = userDatabase[username];
            if (!user) return;
            
            const newPassword = prompt('‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà:', '');
            if (newPassword && newPassword.trim() !== '') {
                user.password = newPassword.trim();
                alert(`‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\nUsername: ${username}\n‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà: ${newPassword}`);
            }
        }

        function deleteUser(username) {
            const user = userDatabase[username];
            if (!user) return;
            
            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ "${user.fullName}" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                delete userDatabase[username];
                loadUsersList();
                alert('‚úÖ ‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            }
        }

        function loadAdminRequests() {
            const adminRequestList = document.getElementById('adminRequestList');
            
            if (Object.keys(requestDatabase).length === 0) {
                adminRequestList.innerHTML = '<div class="text-gray-500 text-center py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>';
                return;
            }

            adminRequestList.innerHTML = '';
            
            Object.values(requestDatabase).forEach(request => {
                const requestElement = document.createElement('div');
                requestElement.className = 'bg-white border border-gray-200 rounded-lg p-4';
                
                // Get current step
                let currentStep = '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠';
                let currentStepIndex = 0;
                request.progress.forEach((step, index) => {
                    if (step.status === 'completed' || step.status === 'in-progress') {
                        currentStep = step.step;
                        currentStepIndex = index;
                    }
                });

                requestElement.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="font-semibold text-lg text-gray-800">${request.id}</h4>
                            <p class="text-sm text-gray-600">‡∏ú‡∏π‡πâ‡∏Ç‡∏≠: ${request.fullName} (${request.studentId})</p>
                            <p class="text-sm text-gray-600">‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${request.submitDate} ${request.submitTime}</p>
                        </div>
                        <div class="text-right">
                            <span class="px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full">
                                ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà ${currentStepIndex + 1}: ${currentStep}
                            </span>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <h5 class="font-medium text-gray-700 mb-2">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠:</h5>
                        <ul class="list-disc list-inside text-sm text-gray-600 ml-2">
                            ${request.documents.map(doc => `<li>${doc} (${request.quantity} ‡∏â‡∏ö‡∏±‡∏ö)</li>`).join('')}
                        </ul>
                    </div>

                    <div class="mb-4">
                        <h5 class="font-medium text-gray-700 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤:</h5>
                        <div class="grid grid-cols-5 gap-2">
                            ${request.progress.map((step, index) => {
                                let bgColor = 'bg-gray-100';
                                let textColor = 'text-gray-500';
                                let icon = '‚è≥';
                                
                                if (step.status === 'completed') {
                                    bgColor = 'bg-green-100';
                                    textColor = 'text-green-700';
                                    icon = '‚úÖ';
                                } else if (step.status === 'in-progress') {
                                    bgColor = 'bg-blue-100';
                                    textColor = 'text-blue-700';
                                    icon = 'üîÑ';
                                }
                                
                                return `
                                    <div class="text-center">
                                        <div class="${bgColor} ${textColor} p-2 rounded-lg text-xs font-medium mb-1">
                                            ${icon}<br>${step.step}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <div class="flex flex-wrap gap-2">
                        ${request.progress.map((step, index) => {
                            // Show button for next pending step only
                            if (step.status === 'pending') {
                                // Check if previous step is completed (or it's the first step)
                                if (index === 0 || request.progress[index - 1].status === 'completed') {
                                    return `<button onclick="updateProgressStep('${request.id}', ${index})" class="px-3 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600">
                                        ‚úÖ ‡∏ó‡∏≥${step.step}‡πÄ‡∏™‡∏£‡πá‡∏à
                                    </button>`;
                                }
                            }
                            return '';
                        }).join('')}
                        
                        <button onclick="viewRequestDetails('${request.id}')" class="px-3 py-1 bg-purple-500 text-white text-xs rounded hover:bg-purple-600">
                            üëÅÔ∏è ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                        </button>
                        
                        <button onclick="resetProgress('${request.id}')" class="px-3 py-1 bg-orange-500 text-white text-xs rounded hover:bg-orange-600">
                            üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                        </button>
                    </div>
                `;
                
                adminRequestList.appendChild(requestElement);
            });
        }

        function updateProgressStep(requestId, stepIndex) {
            const request = requestDatabase[requestId];
            if (!request) return;

            // Update the step to completed
            request.progress[stepIndex].status = 'completed';
            request.progress[stepIndex].time = new Date().toLocaleString('th-TH');

            // Set next step to pending (not in-progress, let admin control manually)
            if (stepIndex + 1 < request.progress.length) {
                request.progress[stepIndex + 1].status = 'pending';
            }

            // Update overall status
            let newStatus = request.progress[stepIndex].step;
            if (stepIndex === request.progress.length - 1) {
                request.status = 'ready';
                newStatus = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£';
            }

            // Send status update to Google Sheets
            const updateData = {
                requestId: requestId,
                status: newStatus,
                stepCompleted: request.progress[stepIndex].step,
                updateTime: new Date().toLocaleString('th-TH')
            };

            sendToGoogleSheets('updateStatus', updateData).then(result => {
                if (result.success) {
                    console.log('‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ô Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                } else {
                    console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Google Sheets:', result.error);
                }
            });

            // Reload admin panel
            loadAdminRequests();
            
            alert(`‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "${request.progress[stepIndex].step}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
        }

        function resetProgress(requestId) {
            const request = requestDatabase[requestId];
            if (!request) return;

            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                // Reset all steps except the first one
                request.progress.forEach((step, index) => {
                    if (index === 0) {
                        step.status = 'completed'; // Keep first step as completed
                    } else {
                        step.status = 'pending';
                        step.time = '';
                    }
                });

                request.status = 'submitted';

                // Reload admin panel
                loadAdminRequests();
                
                alert('üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        function viewRequestDetails(requestId) {
            const request = requestDatabase[requestId];
            if (!request) return;

            let details = `üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏Ç‡∏≠: ${requestId}\n\n`;
            details += `üë§ ‡∏ú‡∏π‡πâ‡∏Ç‡∏≠: ${request.fullName}\n`;
            if (request.hasNameChange) {
                details += `üîÑ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏Å‡πà‡∏≤: ${request.oldName}\n`;
            }
            details += `üÜî ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ${request.studentId}\n`;
            details += `üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û: ${request.studentStatus === 'current' ? 'üéì ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô' : 'üë®‚Äçüéì ‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤'}\n`;
            if (request.studentStatus === 'current' && request.faculty) {
                details += `üéì ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô: ${request.faculty}\n`;
            }
            if (request.studentStatus === 'alumni' && request.graduationYear) {
                details += `üìÖ ‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏ö: ${request.graduationYear}\n`;
            }
            details += `üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${request.phone}\n`;
            details += `üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ${request.purpose}\n`;
            details += `üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô: ${request.submitDate} ${request.submitTime}\n\n`;
            details += `üìÑ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠:\n`;
            request.documents.forEach(doc => {
                details += `‚Ä¢ ${doc} (${request.quantity} ‡∏â‡∏ö‡∏±‡∏ö)\n`;
            });

            alert(details);
        }

        // Statistics Functions
        function loadStatistics() {
            updateSummaryCards();
            generateDocumentTypesChart();
            generateMonthlyChart();
            generateStatusChart();
            loadRecentActivity();
        }

        function updateSummaryCards() {
            const requests = Object.values(requestDatabase);
            const today = new Date().toLocaleDateString('th-TH');
            
            // Total requests
            document.getElementById('totalRequests').textContent = requests.length;
            
            // Completed requests (last step completed)
            const completed = requests.filter(req => 
                req.progress[req.progress.length - 1].status === 'completed'
            ).length;
            document.getElementById('completedRequests').textContent = completed;
            
            // Pending requests
            const pending = requests.length - completed;
            document.getElementById('pendingRequests').textContent = pending;
            
            // Today's requests
            const todayRequests = requests.filter(req => req.submitDate === today).length;
            document.getElementById('todayRequests').textContent = todayRequests;
        }

        function generateDocumentTypesChart() {
            const documentTypes = {};
            
            Object.values(requestDatabase).forEach(request => {
                request.documents.forEach(doc => {
                    documentTypes[doc] = (documentTypes[doc] || 0) + parseInt(request.quantity);
                });
            });

            const chartContainer = document.getElementById('documentTypesChart');
            chartContainer.innerHTML = '';

            if (Object.keys(documentTypes).length === 0) {
                chartContainer.innerHTML = '<div class="text-gray-500 text-center py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
                return;
            }

            const maxCount = Math.max(...Object.values(documentTypes));
            const colors = ['bg-blue-500', 'bg-green-500', 'bg-yellow-500', 'bg-red-500', 'bg-purple-500'];

            Object.entries(documentTypes)
                .sort(([,a], [,b]) => b - a)
                .forEach(([docType, count], index) => {
                    const percentage = (count / maxCount) * 100;
                    const color = colors[index % colors.length];
                    
                    const barElement = document.createElement('div');
                    barElement.className = 'flex items-center space-x-3';
                    barElement.innerHTML = `
                        <div class="w-32 text-sm text-gray-700 truncate">${docType}</div>
                        <div class="flex-1 bg-gray-200 rounded-full h-4 relative">
                            <div class="${color} h-4 rounded-full transition-all duration-500" style="width: ${percentage}%"></div>
                        </div>
                        <div class="w-12 text-sm font-medium text-gray-700">${count}</div>
                    `;
                    chartContainer.appendChild(barElement);
                });
        }

        function generateMonthlyChart() {
            const monthlyData = {};
            const months = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];
            
            // Initialize current year months
            const currentYear = new Date().getFullYear();
            months.forEach((month, index) => {
                monthlyData[`${index + 1}/${currentYear}`] = 0;
            });

            Object.values(requestDatabase).forEach(request => {
                const dateParts = request.submitDate.split('/');
                if (dateParts.length === 3) {
                    const monthYear = `${dateParts[1]}/${dateParts[2]}`;
                    monthlyData[monthYear] = (monthlyData[monthYear] || 0) + 1;
                }
            });

            const chartContainer = document.getElementById('monthlyChart');
            chartContainer.innerHTML = '';

            const maxCount = Math.max(...Object.values(monthlyData), 1);
            
            Object.entries(monthlyData).forEach(([monthYear, count]) => {
                const [month, year] = monthYear.split('/');
                const monthName = months[parseInt(month) - 1];
                const percentage = (count / maxCount) * 100;
                
                const barElement = document.createElement('div');
                barElement.className = 'flex items-center space-x-3';
                barElement.innerHTML = `
                    <div class="w-16 text-sm text-gray-700">${monthName}</div>
                    <div class="flex-1 bg-gray-200 rounded-full h-4 relative">
                        <div class="bg-indigo-500 h-4 rounded-full transition-all duration-500" style="width: ${percentage}%"></div>
                    </div>
                    <div class="w-8 text-sm font-medium text-gray-700">${count}</div>
                `;
                chartContainer.appendChild(barElement);
            });
        }

        function generateStatusChart() {
            const statusData = {
                '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠': 0,
                '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•': 0,
                '‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£': 0,
                '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£': 0,
                '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£': 0
            };

            Object.values(requestDatabase).forEach(request => {
                // Find current step
                let currentStep = '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠';
                request.progress.forEach(step => {
                    if (step.status === 'completed' || step.status === 'in-progress') {
                        currentStep = step.step;
                    }
                });
                statusData[currentStep]++;
            });

            const chartContainer = document.getElementById('statusChart');
            chartContainer.innerHTML = '';

            const colors = ['bg-blue-500', 'bg-yellow-500', 'bg-orange-500', 'bg-purple-500', 'bg-green-500'];
            const icons = ['üìã', 'üîç', 'üìù', '‚úÖ', 'üéâ'];

            Object.entries(statusData).forEach(([status, count], index) => {
                const statusElement = document.createElement('div');
                statusElement.className = `${colors[index]} text-white rounded-lg p-4 text-center`;
                statusElement.innerHTML = `
                    <div class="text-2xl mb-2">${icons[index]}</div>
                    <div class="text-2xl font-bold mb-1">${count}</div>
                    <div class="text-xs opacity-90">${status}</div>
                `;
                chartContainer.appendChild(statusElement);
            });
        }

        function loadRecentActivity() {
            const activityContainer = document.getElementById('recentActivity');
            const activities = [];

            // Collect all activities from requests
            Object.values(requestDatabase).forEach(request => {
                request.progress.forEach(step => {
                    if (step.status === 'completed' && step.time) {
                        activities.push({
                            type: 'progress',
                            message: `${request.fullName} - ${step.step} (${request.id})`,
                            time: step.time,
                            timestamp: new Date(step.time).getTime()
                        });
                    }
                });

                // Add submission activity
                activities.push({
                    type: 'submit',
                    message: `${request.fullName} ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (${request.id})`,
                    time: `${request.submitDate} ${request.submitTime}`,
                    timestamp: new Date(`${request.submitDate} ${request.submitTime}`).getTime()
                });
            });

            // Sort by timestamp (newest first)
            activities.sort((a, b) => b.timestamp - a.timestamp);

            activityContainer.innerHTML = '';

            if (activities.length === 0) {
                activityContainer.innerHTML = '<div class="text-gray-500 text-center py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>';
                return;
            }

            // Show latest 10 activities
            activities.slice(0, 10).forEach(activity => {
                const activityElement = document.createElement('div');
                activityElement.className = 'flex items-center space-x-3 p-3 bg-gray-50 rounded-lg';
                
                const icon = activity.type === 'submit' ? 'üì§' : '‚úÖ';
                const color = activity.type === 'submit' ? 'text-blue-600' : 'text-green-600';
                
                activityElement.innerHTML = `
                    <div class="text-lg">${icon}</div>
                    <div class="flex-1">
                        <div class="text-sm ${color} font-medium">${activity.message}</div>
                        <div class="text-xs text-gray-500">‚è∞ ${activity.time}</div>
                    </div>
                `;
                activityContainer.appendChild(activityElement);
            });
        }

        // Management Functions
        function showManagementLogin() {
            document.getElementById('managementLoginModal').classList.remove('hidden');
        }

        function hideManagementLogin() {
            document.getElementById('managementLoginModal').classList.add('hidden');
        }

        document.getElementById('managementLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('managementUsername').value;
            const password = document.getElementById('managementPassword').value;
            
            // Check against user database
            const user = userDatabase[username];
            if (user && user.password === password && user.role === 'management') {
                isManagementLoggedIn = true;
                hideManagementLogin();
                showManagementPage();
                loadManagementDashboard();
                alert(`‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ${user.fullName}`);
            } else {
                alert('‚ùå Username ‡∏´‡∏£‡∏∑‡∏≠ Password ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£');
            }
        });

        function showManagementPage() {
            document.getElementById('mainPage').classList.add('hidden');
            document.getElementById('managementPage').classList.remove('hidden');
            updateManagementNotificationDisplay();
        }

        function hideManagementPage() {
            document.getElementById('managementPage').classList.add('hidden');
            document.getElementById('mainPage').classList.remove('hidden');
            updateManagementNotificationDisplay();
        }

        function managementLogout() {
            isManagementLoggedIn = false;
            hideManagementPage();
            updateManagementNotificationDisplay();
            alert('üëã ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß');
        }

        // Management Notification Functions
        function addManagementNotification(notification) {
            managementNotifications.unshift(notification); // Add to beginning of array
            updateManagementNotificationDisplay();
            loadManagementNotificationsList();
        }

        function updateManagementNotificationDisplay() {
            const managementNotificationBell = document.getElementById('managementNotificationBell');
            const managementNotificationBadge = document.getElementById('managementNotificationBadge');
            
            if (isManagementLoggedIn) {
                const unreadCount = managementNotifications.filter(n => !n.isRead).length;
                if (unreadCount > 0) {
                    managementNotificationBadge.classList.remove('hidden');
                    managementNotificationBadge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                    
                    // Add pulsing animation for new notifications
                    managementNotificationBell.classList.add('animate-pulse');
                    setTimeout(() => {
                        managementNotificationBell.classList.remove('animate-pulse');
                    }, 3000);
                } else {
                    managementNotificationBadge.classList.add('hidden');
                }
            }
        }

        function showManagementNotifications() {
            document.getElementById('managementNotificationModal').classList.remove('hidden');
            loadManagementNotificationsModal();
        }

        function hideManagementNotifications() {
            document.getElementById('managementNotificationModal').classList.add('hidden');
        }

        function loadManagementNotificationsModal() {
            const notificationList = document.getElementById('managementNotificationModalList');
            
            if (managementNotifications.length === 0) {
                notificationList.innerHTML = '<div class="text-gray-500 text-center py-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà</div>';
                return;
            }

            notificationList.innerHTML = '';
            
            managementNotifications.forEach(notification => {
                const notificationElement = document.createElement('div');
                notificationElement.className = `border rounded-lg p-3 cursor-pointer hover:bg-gray-50 ${
                    notification.isRead ? 'bg-gray-50 border-gray-200' : 'bg-blue-50 border-blue-200'
                }`;
                
                notificationElement.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-gray-800 text-sm">${notification.title}</h4>
                        <div class="flex items-center space-x-2">
                            ${!notification.isRead ? '<span class="w-2 h-2 bg-blue-500 rounded-full"></span>' : ''}
                            <button onclick="deleteManagementNotification('${notification.id}')" class="text-red-500 hover:text-red-700 text-xs">üóëÔ∏è</button>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm mb-2">${notification.message}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-xs text-gray-500">‚è∞ ${notification.timestamp}</span>
                        ${notification.requestId ? `<button onclick="viewRequestFromManagementNotification('${notification.requestId}')" class="text-blue-600 hover:text-blue-800 text-xs font-medium">üëÅÔ∏è ‡∏î‡∏π‡∏Ñ‡∏≥‡∏Ç‡∏≠</button>` : ''}
                    </div>
                `;
                
                // Mark as read when clicked
                notificationElement.addEventListener('click', () => {
                    if (!notification.isRead) {
                        notification.isRead = true;
                        updateManagementNotificationDisplay();
                        loadManagementNotificationsModal();
                        loadManagementNotificationsList();
                    }
                });
                
                notificationList.appendChild(notificationElement);
            });
        }

        function loadManagementNotificationsList() {
            const notificationsList = document.getElementById('managementNotificationsList');
            
            if (managementNotifications.length === 0) {
                notificationsList.innerHTML = '<div class="text-gray-500 text-center py-8">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà</div>';
                return;
            }

            notificationsList.innerHTML = '';
            
            // Show latest 5 notifications
            managementNotifications.slice(0, 5).forEach(notification => {
                const notificationElement = document.createElement('div');
                notificationElement.className = `border rounded-lg p-3 cursor-pointer hover:bg-gray-50 ${
                    notification.isRead ? 'bg-gray-50 border-gray-200' : 'bg-blue-50 border-blue-200'
                }`;
                
                notificationElement.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-gray-800 text-sm">${notification.title}</h4>
                        ${!notification.isRead ? '<span class="w-2 h-2 bg-blue-500 rounded-full"></span>' : ''}
                    </div>
                    <p class="text-gray-600 text-sm mb-2">${notification.message}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-xs text-gray-500">‚è∞ ${notification.timestamp}</span>
                        ${notification.requestId ? `<button onclick="viewRequestFromManagementNotification('${notification.requestId}')" class="text-blue-600 hover:text-blue-800 text-xs font-medium">üëÅÔ∏è ‡∏î‡∏π‡∏Ñ‡∏≥‡∏Ç‡∏≠</button>` : ''}
                    </div>
                `;
                
                // Mark as read when clicked
                notificationElement.addEventListener('click', () => {
                    if (!notification.isRead) {
                        notification.isRead = true;
                        updateManagementNotificationDisplay();
                        loadManagementNotificationsList();
                    }
                });
                
                notificationsList.appendChild(notificationElement);
            });
        }

        function markAllManagementAsRead() {
            managementNotifications.forEach(notification => {
                notification.isRead = true;
            });
            updateManagementNotificationDisplay();
            loadManagementNotificationsModal();
            loadManagementNotificationsList();
            alert('‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
        }

        function clearAllManagementNotifications() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                managementNotifications = [];
                updateManagementNotificationDisplay();
                loadManagementNotificationsModal();
                loadManagementNotificationsList();
                alert('üóëÔ∏è ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        function deleteManagementNotification(notificationId) {
            managementNotifications = managementNotifications.filter(n => n.id !== notificationId);
            updateManagementNotificationDisplay();
            loadManagementNotificationsModal();
            loadManagementNotificationsList();
        }

        function viewRequestFromManagementNotification(requestId) {
            hideManagementNotifications();
            
            // Show request details in alert for now
            const request = requestDatabase[requestId];
            if (request) {
                let details = `üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏Ç‡∏≠: ${requestId}\n\n`;
                details += `üë§ ‡∏ú‡∏π‡πâ‡∏Ç‡∏≠: ${request.fullName}\n`;
                details += `üÜî ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ${request.studentId}\n`;
                details += `üéì ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô: ${request.faculty}\n`;
                details += `üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô: ${request.submitDate} ${request.submitTime}\n\n`;
                details += `üìÑ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠:\n`;
                request.documents.forEach(doc => {
                    details += `‚Ä¢ ${doc} (${request.quantity} ‡∏â‡∏ö‡∏±‡∏ö)\n`;
                });
                
                // Get current step
                let currentStep = '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠';
                request.progress.forEach(step => {
                    if (step.status === 'completed' || step.status === 'in-progress') {
                        currentStep = step.step;
                    }
                });
                details += `\nüîÑ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ${currentStep}`;
                
                alert(details);
            }
        }

        // Management Dashboard Functions
        function loadManagementDashboard() {
            updateManagementSummaryCards();
            loadManagementNotificationsList();
            loadManagementRequestsList();
            generatePerformanceChart();
        }

        function updateManagementSummaryCards() {
            const requests = Object.values(requestDatabase);
            const today = new Date().toLocaleDateString('th-TH');
            
            // Total requests
            document.getElementById('mgmtTotalRequests').textContent = requests.length;
            
            // Pending requests (not completed)
            const pending = requests.filter(req => 
                req.progress[req.progress.length - 1].status !== 'completed'
            ).length;
            document.getElementById('mgmtPendingRequests').textContent = pending;
            
            // Completed today
            const completedToday = requests.filter(req => {
                const lastStep = req.progress[req.progress.length - 1];
                return lastStep.status === 'completed' && lastStep.time && lastStep.time.includes(today);
            }).length;
            document.getElementById('mgmtCompletedToday').textContent = completedToday;
            
            // Overdue requests (submitted more than 3 days ago and not completed)
            const threeDaysAgo = new Date();
            threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);
            const overdue = requests.filter(req => {
                const submitDate = new Date(req.submitDate);
                const isOverdue = submitDate < threeDaysAgo;
                const isNotCompleted = req.progress[req.progress.length - 1].status !== 'completed';
                return isOverdue && isNotCompleted;
            }).length;
            document.getElementById('mgmtOverdueRequests').textContent = overdue;
        }

        function loadManagementRequestsList() {
            const requestsList = document.getElementById('managementRequestsList');
            
            if (Object.keys(requestDatabase).length === 0) {
                requestsList.innerHTML = '<div class="text-gray-500 text-center py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>';
                return;
            }

            requestsList.innerHTML = '';
            
            // Show latest 10 requests
            const recentRequests = Object.values(requestDatabase)
                .sort((a, b) => new Date(`${b.submitDate} ${b.submitTime}`) - new Date(`${a.submitDate} ${a.submitTime}`))
                .slice(0, 10);
            
            recentRequests.forEach(request => {
                // Get current step
                let currentStep = '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠';
                let currentStepIndex = 0;
                request.progress.forEach((step, index) => {
                    if (step.status === 'completed' || step.status === 'in-progress') {
                        currentStep = step.step;
                        currentStepIndex = index;
                    }
                });

                const requestElement = document.createElement('div');
                requestElement.className = 'bg-gray-50 border border-gray-200 rounded-lg p-4';
                
                requestElement.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="font-semibold text-gray-800">${request.id}</h4>
                            <p class="text-sm text-gray-600">üë§ ${request.fullName} (${request.studentId})</p>
                            <p class="text-sm text-gray-600">üìÖ ‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${request.submitDate}</p>
                        </div>
                        <div class="text-right">
                            <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full">
                                ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà ${currentStepIndex + 1}: ${currentStep}
                            </span>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <p class="text-sm text-gray-700"><strong>üìÑ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</strong></p>
                        <ul class="list-disc list-inside text-sm text-gray-600 ml-2">
                            ${request.documents.map(doc => `<li>${doc} (${request.quantity} ‡∏â‡∏ö‡∏±‡∏ö)</li>`).join('')}
                        </ul>
                    </div>

                    <div class="text-center">
                        <button onclick="viewRequestFromManagementNotification('${request.id}')" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            üëÅÔ∏è ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏ï‡πá‡∏°
                        </button>
                    </div>
                `;
                
                requestsList.appendChild(requestElement);
            });
        }

        function generatePerformanceChart() {
            const chartContainer = document.getElementById('performanceChart');
            chartContainer.innerHTML = '';

            // Generate data for last 7 days
            const days = ['‡∏≠‡∏≤', '‡∏à', '‡∏≠', '‡∏û', '‡∏û‡∏§', '‡∏®', '‡∏™'];
            const today = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toLocaleDateString('th-TH');
                const dayName = days[date.getDay()];
                
                // Count completed requests for this day
                const completedCount = Object.values(requestDatabase).filter(req => {
                    return req.progress.some(step => 
                        step.status === 'completed' && step.time && step.time.includes(dateStr)
                    );
                }).length;
                
                const maxHeight = 100; // Max height in pixels
                const height = Math.max(20, (completedCount / Math.max(1, 5)) * maxHeight); // Scale to max 5 requests
                
                const dayElement = document.createElement('div');
                dayElement.className = 'text-center';
                dayElement.innerHTML = `
                    <div class="flex flex-col items-center justify-end h-32 mb-2">
                        <div class="bg-indigo-500 rounded-t w-8 transition-all duration-500" style="height: ${height}px"></div>
                        <div class="text-xs font-medium text-gray-700 mt-1">${completedCount}</div>
                    </div>
                    <div class="text-xs text-gray-600">${dayName}</div>
                `;
                chartContainer.appendChild(dayElement);
            }
        }

        // Management Quick Actions
        function viewAllPendingRequests() {
            const pending = Object.values(requestDatabase).filter(req => 
                req.progress[req.progress.length - 1].status !== 'completed'
            );
            
            if (pending.length === 0) {
                alert('‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£');
                return;
            }
            
            let message = `üìã ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (${pending.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£):\n\n`;
            pending.forEach(req => {
                let currentStep = '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠';
                req.progress.forEach(step => {
                    if (step.status === 'completed' || step.status === 'in-progress') {
                        currentStep = step.step;
                    }
                });
                message += `‚Ä¢ ${req.id} - ${req.fullName} (${currentStep})\n`;
            });
            
            alert(message);
        }

        function viewTodayActivity() {
            const today = new Date().toLocaleDateString('th-TH');
            const todayRequests = Object.values(requestDatabase).filter(req => 
                req.submitDate === today
            );
            const todayCompleted = Object.values(requestDatabase).filter(req => {
                const lastStep = req.progress[req.progress.length - 1];
                return lastStep.status === 'completed' && lastStep.time && lastStep.time.includes(today);
            });
            
            let message = `üìÖ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (${today}):\n\n`;
            message += `üìã ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà: ${todayRequests.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
            message += `‚úÖ ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô: ${todayCompleted.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n\n`;
            
            if (todayRequests.length > 0) {
                message += `‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà:\n`;
                todayRequests.forEach(req => {
                    message += `‚Ä¢ ${req.id} - ${req.fullName}\n`;
                });
            }
            
            if (todayCompleted.length > 0) {
                message += `\n‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô:\n`;
                todayCompleted.forEach(req => {
                    message += `‚Ä¢ ${req.id} - ${req.fullName}\n`;
                });
            }
            
            alert(message);
        }

        function generateReport() {
            const requests = Object.values(requestDatabase);
            const completed = requests.filter(req => 
                req.progress[req.progress.length - 1].status === 'completed'
            ).length;
            const pending = requests.length - completed;
            
            let report = `üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£\n`;
            report += `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${new Date().toLocaleDateString('th-TH')}\n\n`;
            report += `üìã ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${requests.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
            report += `‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß: ${completed} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (${((completed/requests.length)*100).toFixed(1)}%)\n`;
            report += `‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£: ${pending} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (${((pending/requests.length)*100).toFixed(1)}%)\n\n`;
            
            // Document types summary
            const documentTypes = {};
            requests.forEach(req => {
                req.documents.forEach(doc => {
                    documentTypes[doc] = (documentTypes[doc] || 0) + parseInt(req.quantity);
                });
            });
            
            if (Object.keys(documentTypes).length > 0) {
                report += `üìÑ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:\n`;
                Object.entries(documentTypes)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 5)
                    .forEach(([doc, count]) => {
                        report += `‚Ä¢ ${doc}: ${count} ‡∏â‡∏ö‡∏±‡∏ö\n`;
                    });
            }
            
            alert(report);
        }

        function viewOverdueRequests() {
            const threeDaysAgo = new Date();
            threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);
            
            const overdue = Object.values(requestDatabase).filter(req => {
                const submitDate = new Date(req.submitDate);
                const isOverdue = submitDate < threeDaysAgo;
                const isNotCompleted = req.progress[req.progress.length - 1].status !== 'completed';
                return isOverdue && isNotCompleted;
            });
            
            if (overdue.length === 0) {
                alert('‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î');
                return;
            }
            
            let message = `üö® ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î (${overdue.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£):\n\n`;
            overdue.forEach(req => {
                const daysPassed = Math.floor((new Date() - new Date(req.submitDate)) / (1000 * 60 * 60 * 24));
                let currentStep = '‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠';
                req.progress.forEach(step => {
                    if (step.status === 'completed' || step.status === 'in-progress') {
                        currentStep = step.step;
                    }
                });
                message += `‚Ä¢ ${req.id} - ${req.fullName} (${daysPassed} ‡∏ß‡∏±‡∏ô, ${currentStep})\n`;
            });
            
            alert(message);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97595092020c7993',t:'MTc1NjI3NDA3MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
